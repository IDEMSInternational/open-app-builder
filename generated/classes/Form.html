<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
        <link rel="stylesheet" href="../styles/material.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">frontend documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content class">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Classes</li>
  <li >Form</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts</code>
        </p>






            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#addModule" >addModule</a>
                            </li>
                            <li>
                                <a href="#all" >all</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#blockPageNavigation" >blockPageNavigation</a>
                            </li>
                            <li>
                                <a href="#calc" >calc</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#clearNonRelevant" >clearNonRelevant</a>
                            </li>
                            <li>
                                <a href="#evaluationCascadeAdditions" >evaluationCascadeAdditions</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#filterRadioCheckSiblings" >filterRadioCheckSiblings</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getDataStr" >getDataStr</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getDataStrWithoutIrrelevantNodes" >getDataStrWithoutIrrelevantNodes</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getGoToTarget" >getGoToTarget</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getModelValue" >getModelValue</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getQuerySelectorsForLogic" >getQuerySelectorsForLogic</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#getRelatedNodes" >getRelatedNodes</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#goTo" >goTo</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#goToTarget" >goToTarget</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#grosslyViolateStandardComplianceByIgnoringCertainCalcs" >grosslyViolateStandardComplianceByIgnoringCertainCalcs</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#init" >init</a>
                            </li>
                            <li>
                                <a href="#initialized" >initialized</a>
                            </li>
                            <li>
                                <a href="#input" >input</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#isValid" >isValid</a>
                            </li>
                            <li>
                                <a href="#itemset" >itemset</a>
                            </li>
                            <li>
                                <a href="#langs" >langs</a>
                            </li>
                            <li>
                                <a href="#mask" >mask</a>
                            </li>
                            <li>
                                <a href="#model" >model</a>
                            </li>
                            <li>
                                <a href="#nodePathToRepeatPath" >nodePathToRepeatPath</a>
                            </li>
                            <li>
                                <a href="#nonRepeats" >nonRepeats</a>
                            </li>
                            <li>
                                <a href="#options" >options</a>
                            </li>
                            <li>
                                <a href="#output" >output</a>
                            </li>
                            <li>
                                <a href="#pageNavigationBlocked" >pageNavigationBlocked</a>
                            </li>
                            <li>
                                <a href="#pages" >pages</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#pathToAbsolute" >pathToAbsolute</a>
                            </li>
                            <li>
                                <a href="#preloads" >preloads</a>
                            </li>
                            <li>
                                <a href="#progress" >progress</a>
                            </li>
                            <li>
                                <a href="#readonly" >readonly</a>
                            </li>
                            <li>
                                <a href="#relevant" >relevant</a>
                            </li>
                            <li>
                                <a href="#repeatPathPrefixes" >repeatPathPrefixes</a>
                            </li>
                            <li>
                                <a href="#repeats" >repeats</a>
                            </li>
                            <li>
                                <a href="#repeatsInitialized" >repeatsInitialized</a>
                            </li>
                            <li>
                                <a href="#repeatsPresent" >repeatsPresent</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#replaceChoiceNameFn" >replaceChoiceNameFn</a>
                            </li>
                            <li>
                                <a href="#required" >required</a>
                            </li>
                            <li>
                                <a href="#requiredTransformerVersion" >requiredTransformerVersion</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#resetView" >resetView</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setAllVals" >setAllVals</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setEventHandlers" >setEventHandlers</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setInvalid" >setInvalid</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#setValid" >setValid</a>
                            </li>
                            <li>
                                <a href="#toc" >toc</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#updateValidityInUi" >updateValidityInUi</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#validate" >validate</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#validateAll" >validateAll</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#validateContent" >validateContent</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#validateInput" >validateInput</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#validationUpdate" >validationUpdate</a>
                            </li>
                            <li>
                                <a href="#view" >view</a>
                            </li>
                            <li>
                                <a href="#widgets" >widgets</a>
                            </li>
                            <li>
                                <a href="#widgetsInitialized" >widgetsInitialized</a>
                            </li>
                        </ul>
                    </td>
                </tr>






                    <tr>
                        <td class="col-md-4">
                            <h6><b>Accessors</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                    <a href="#evaluationCascade" >evaluationCascade</a>
                                </li>
                                <li>
                                    <a href="#recordName" >recordName</a>
                                </li>
                                <li>
                                    <a href="#editStatus" >editStatus</a>
                                </li>
                                <li>
                                    <a href="#surveyName" >surveyName</a>
                                </li>
                                <li>
                                    <a href="#instanceID" >instanceID</a>
                                </li>
                                <li>
                                    <a href="#deprecatedID" >deprecatedID</a>
                                </li>
                                <li>
                                    <a href="#instanceName" >instanceName</a>
                                </li>
                                <li>
                                    <a href="#version" >version</a>
                                </li>
                                <li>
                                    <a href="#encryptionKey" >encryptionKey</a>
                                </li>
                                <li>
                                    <a href="#action" >action</a>
                                </li>
                                <li>
                                    <a href="#method" >method</a>
                                </li>
                                <li>
                                    <a href="#id" >id</a>
                                </li>
                                <li>
                                    <a href="#constraintClassesInvalid" >constraintClassesInvalid</a>
                                </li>
                                <li>
                                    <a href="#constraintAttributes" >constraintAttributes</a>
                                </li>
                                <li>
                                    <a href="#languages" >languages</a>
                                </li>
                                <li>
                                    <a href="#currentLanguage" >currentLanguage</a>
                                </li>
                            </ul>
                        </td>
                    </tr>
        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(formEl: HTMLElement, data, options: <a href="../classes/Form.html" target="_self">FormOptions</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="91" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:91</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Most methods are prototype method to facilitate customizations outside of enketo-core.</p>
</div>
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Description</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>formEl</td>
                                                  
                                                        <td>
                                                                    <code>HTMLElement</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                        <td>
                                                                <ul>
<li>HTML form element (a product of Enketo Transformer after transforming a valid ODK XForm)</li>
</ul>

                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>data</td>
                                                  
                                                        <td>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                        <td>
                                                                <ul>
<li>Data object containing XML model, (partial) XML instance-to-load, external data and flag about whether instance-to-load has already been submitted before.</li>
</ul>

                                                        </td>
                                                </tr>
                                                <tr>
                                                        <td>options</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Form.html" target="_self" >FormOptions</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                        <td>
                                                        </td>
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="addModule"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>addModule</b></span>
                        <a href="#addModule"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (module) {
    return Object.create(module, {
      form: {
        value: this,
      },
    });
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="268" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:268</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Returns a module and adds the form property to it.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>module</td>
                                                    <td>
                                                            <code><ul>
<li>Enketo Core module</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="all"></a>
                    <span class="name">
                        <span ><b>all</b></span>
                        <a href="#all"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>literal type</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="52" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:52</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="blockPageNavigation"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>blockPageNavigation</b></span>
                        <a href="#blockPageNavigation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    const that &#x3D; this;
    this.pageNavigationBlocked &#x3D; true;
    window.clearTimeout(this.blockPageNavigationTimeout);
    this.blockPageNavigationTimeout &#x3D; window.setTimeout(() &#x3D;&gt; {
      that.pageNavigationBlocked &#x3D; false;
    }, 600);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1070" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1070</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Blocks page navigation for a short period.
This can be used to ensure that the user sees a new error message before moving to another page.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="calc"></a>
                    <span class="name">
                        <span ><b>calc</b></span>
                        <a href="#calc"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="77" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:77</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="clearNonRelevant"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>clearNonRelevant</b></span>
                        <a href="#clearNonRelevant"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    this.relevant.update(null, true);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1102" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1102</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Clears non-relevant values.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="evaluationCascadeAdditions"></a>
                    <span class="name">
                        <span ><b>evaluationCascadeAdditions</b></span>
                        <a href="#evaluationCascadeAdditions"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>any[]</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>[]</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="91" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:91</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="filterRadioCheckSiblings"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>filterRadioCheckSiblings</b></span>
                        <a href="#filterRadioCheckSiblings"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>() &#x3D;&gt; {...}</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="731" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:731</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>controls</td>
                                                    <td>
                                                            <code><ul>
<li>radiobutton/checkbox HTML input elements</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDataStr"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getDataStr</b></span>
                        <a href="#getDataStr"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (include: any &#x3D; {}) {
    // By default everything is included
    if (include.irrelevant &#x3D;&#x3D;&#x3D; false) {
      return this.getDataStrWithoutIrrelevantNodes();
    }

    return this.model.getStr();
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="478" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:478</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Obtains a string of primary instance.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>include</td>
                                                    <td>
                                                            <code><ul>
<li>Optional object items to exclude if false</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getDataStrWithoutIrrelevantNodes"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getDataStrWithoutIrrelevantNodes</b></span>
                        <a href="#getDataStrWithoutIrrelevantNodes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    const that &#x3D; this;
    const modelClone &#x3D; new FormModel(this.model.getStr());
    modelClone.init();

    // Since we are removing nodes, we need to go in reverse order to make sure
    // the indices are still correct!
    this.getRelatedNodes(&quot;data-relevant&quot;)
      .reverse()
      .each(function () {
        const node &#x3D; this;
        const relevant &#x3D; that.input.getRelevant(node);
        const index &#x3D; that.input.getIndex(node);
        const path &#x3D; that.input.getName(node);
        let target;

        /*
         * Copied from relevant.js:
         *
         * If the relevant is placed on a group and that group contains repeats with the same name,
         * but currently has 0 repeats, the context will not be available.
         */
        if (
          getChild(node, &#x60;.or-repeat-info[data-name&#x3D;&quot;${path}&quot;]&#x60;) &amp;&amp;
          !getChild(node, &#x60;.or-repeat[name&#x3D;&quot;${path}&quot;]&#x60;)
        ) {
          target &#x3D; null;
        } else {
          // If a calculation without a form control (i.e. in .calculated-items) inside a repeat
          // has a relevant, and there 0 instances of that repeat,
          // there is nothing to remove (and target is undefined)
          // https://github.com/enketo/enketo-core/issues/761
          // TODO: It would be so much nicer if form-control-less calculations were placed inside the repeat instead.
          target &#x3D; modelClone.node(path, index).getElement();
        }

        /*
         * If performance becomes an issue, some opportunities are:
         * - check if ancestor is relevant
         * - use cache of relevant.update
         * - check for repeatClones to avoid calculating index (as in relevant.update)
         */
        if (target &amp;&amp; !that.model.evaluate(relevant, &quot;boolean&quot;, path, index)) {
          target.remove();
        }
      });

    return modelClone.getStr();
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="786" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:786</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Obtains the XML primary instance as string without nodes that have a relevant
that evaluates to false.</p>
<p>Though this function may be slow it is slow when it doesn&#39;t matter much (upon saving). The
alternative is to add some logic to relevant.update to mark irrelevant nodes in the model
but that would slow down form loading and form traversal when it does matter.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getGoToTarget"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getGoToTarget</b></span>
                        <a href="#getGoToTarget"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (path) {
    let hits;
    let modelNode;
    let target;
    let intermediateTarget;
    let selector &#x3D; &quot;&quot;;
    const repeatRegEx &#x3D; /([^[]+)\[(\d+)\]([^[]*$)?/g;

    if (!path) {
      return;
    }

    modelNode &#x3D; this.model.node(path).getElement();

    if (!modelNode) {
      return;
    }

    // Convert to absolute path, while maintaining positions.
    path &#x3D; getXPath(modelNode, &quot;instance&quot;, true);

    // Not inside a cloned repeat.
    target &#x3D; this.view.html.querySelector(&#x60;[name&#x3D;&quot;${path}&quot;]&#x60;);

    // If inside a cloned repeat (i.e. a repeat that is not first-in-series)
    if (!target) {
      intermediateTarget &#x3D; this.view.html;
      while ((hits &#x3D; repeatRegEx.exec(path)) !&#x3D;&#x3D; null &amp;&amp; intermediateTarget) {
        selector +&#x3D; hits[1];
        intermediateTarget &#x3D; intermediateTarget.querySelectorAll(
          &#x60;[name&#x3D;&quot;${selector}&quot;], [data-name&#x3D;&quot;${selector}&quot;]&#x60;
        )[hits[2]];
        if (intermediateTarget &amp;&amp; hits[3]) {
          selector +&#x3D; hits[3];
          intermediateTarget &#x3D; intermediateTarget.querySelector(
            &#x60;[name&#x3D;&quot;${selector}&quot;],[data-name&#x3D;&quot;${selector}&quot;]&#x60;
          );
        }
        target &#x3D; intermediateTarget;
      }
    }

    return target ? this.input.getWrapNode(target) : target;
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1279" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1279</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>path</td>
                                                    <td>
                                                            <code><ul>
<li>path to HTML form control</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getModelValue"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getModelValue</b></span>
                        <a href="#getModelValue"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function ($control) {
    const control &#x3D; $control[0];
    const path &#x3D; this.input.getName(control);
    const index &#x3D; this.input.getIndex(control);

    return this.model.node(path, index).getVal();
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="627" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:627</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>$control</td>
                                                    <td>
                                                            <code><ul>
<li>HTML form control</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getQuerySelectorsForLogic"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getQuerySelectorsForLogic</b></span>
                        <a href="#getQuerySelectorsForLogic"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>() &#x3D;&gt; {...}</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="760" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:760</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Crafts an optimized selector for element attributes that contain an expression with a target node name.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>filter</td>
                                                    <td>
                                                            <code><ul>
<li>The filter to use</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>attr</td>
                                                    <td>
                                                            <code><ul>
<li>The attribute to target</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>nodeName</td>
                                                    <td>
                                                            <code><ul>
<li>The XML nodeName to find</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getRelatedNodes"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>getRelatedNodes</b></span>
                        <a href="#getRelatedNodes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (attr, filter, updated) {
    let repeatControls &#x3D; null;
    let controls;
    updated &#x3D; updated || {};
    filter &#x3D; filter || &quot;&quot;;

    const { allRepeats, cloned, repeatPath } &#x3D; updated;

    // The collection of non-repeat inputs, calculations and groups is cached (unchangeable)
    if (!allRepeats &amp;&amp; !this.nonRepeats[attr]) {
      controls &#x3D; [...this.view.html.querySelectorAll(&#x60;:not(.or-repeat-info)[${attr}]&#x60;)].filter(
        (el) &#x3D;&gt; !el.closest(&quot;.or-repeat&quot;)
      );
      this.nonRepeats[attr] &#x3D; this.filterRadioCheckSiblings(controls);
    }

    if (allRepeats) {
      const controls &#x3D; [...this.view.html.querySelectorAll(&#x60;form.or .or-repeat [${attr}]&#x60;)];
      repeatControls &#x3D; this.filterRadioCheckSiblings(controls);
    } else if (typeof repeatPath !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp; updated.repeatIndex &gt;&#x3D; 0) {
      // If the updated node is inside a repeat (and there are multiple repeats present)
      const repeatEl &#x3D; [...this.view.html.querySelectorAll(&#x60;.or-repeat[name&#x3D;&quot;${repeatPath}&quot;]&#x60;)][
        updated.repeatIndex
      ];
      controls &#x3D; repeatEl ? [...repeatEl.querySelectorAll(&#x60;[${attr}]&#x60;)] : [];
      repeatControls &#x3D; this.filterRadioCheckSiblings(controls);
    }

    // If a new repeat was created, update the cached collection of all form controls with that attribute
    // If a repeat was deleted (updated.repeatPath &amp;&amp; !updated.cloned), rebuild cache.
    // Exclude outputs from the cache, because outputs can be added via itemsets (in labels).
    if (!this.all[attr] || (repeatPath &amp;&amp; !cloned) || filter &#x3D;&#x3D;&#x3D; &quot;.or-output&quot;) {
      // (re)build the cache
      // However, if repeats have not been initialized exclude nodes inside a repeat until the first repeat has been added during repeat initialization.
      // The default view repeat will be removed during initialization (and stored as template), before it is re-added, if necessary.
      // We need to avoid adding these fields to the initial cache,
      // so we don&#x27;t waste time evaluating logic, and don&#x27;t have to rebuild the cache after repeats have been initialized.
      this.all[attr] &#x3D; this.repeatsInitialized
        ? this.filterRadioCheckSiblings([...this.view.html.querySelectorAll(&#x60;[${attr}]&#x60;)])
        : this.nonRepeats[attr];
    } else if (cloned &amp;&amp; repeatControls) {
      // update the cache
      this.all[attr] &#x3D; this.all[attr].concat(repeatControls);
    }

    /**
     * If the update was triggered from a repeat, it improves performance (a lot)
     * to exclude all those repeats that did not trigger it...
     * However, this will break if people are referring to nodes in other
     * repeats such as with /path/to/repeat[3]/node, /path/to/repeat[position() &#x3D; 3]/node or indexed-repeat(/path/to/repeat/node, /path/to/repeat, 3).
     * We accept that for now.
     * */
    let collection;
    if (repeatControls) {
      // The non-repeat fields have to be added too, e.g. to update a calculated item with count(to/repeat/node) at the top level
      collection &#x3D; this.nonRepeats[attr].concat(repeatControls);
    } else {
      collection &#x3D; this.all[attr];
    }

    let selector &#x3D; [];
    // Add selectors based on specific changed nodes
    if (!updated.nodes || updated.nodes.length &#x3D;&#x3D;&#x3D; 0) {
      if (repeatControls !&#x3D; null &amp;&amp; cloned &amp;&amp; filter &#x3D;&#x3D;&#x3D; &quot;.itemset-template&quot;) {
        selector &#x3D; [&#x60;.or-repeat[name&#x3D;&quot;${repeatPath}&quot;] ${filter}[${attr}]&#x60;];
      } else {
        selector &#x3D; [&#x60;${filter}[${attr}]&#x60;];
      }
    } else {
      updated.nodes.forEach((node) &#x3D;&gt; {
        selector &#x3D; selector.concat(this.getQuerySelectorsForLogic(filter, attr, node));
      });
      // add all the paths that use the /* selector at end of path
      selector &#x3D; selector.concat(this.getQuerySelectorsForLogic(filter, attr, &quot;*&quot;));
    }

    const selectorStr &#x3D; selector.join(&quot;, &quot;);
    collection &#x3D; selectorStr ? collection.filter((el) &#x3D;&gt; el.matches(selectorStr)) : collection;

    // TODO: exclude descendents of disabled elements? .find( &#x27;:not(:disabled) span.active&#x27; )
    // TODO: remove jQuery wrapper, just return array of elements
    return $(collection);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="643" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:643</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Finds nodes that have attributes with XPath expressions that refer to particular XML elements.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>attr</td>
                                                    <td>
                                                            <code><ul>
<li>The attribute name to search for</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>filter</td>
                                                    <td>
                                                            <code><ul>
<li>The optional filter to append to each selector</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>updated</td>
                                                    <td>
                                                            <code><ul>
<li>object that contains information on updated nodes</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="goTo"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>goTo</b></span>
                        <a href="#goTo"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (xpath) {
    const errors &#x3D; [];
    if (!this.goToTarget(this.getGoToTarget(xpath))) {
      errors.push(
        t(&quot;alert.gotonotfound.msg&quot;, {
          path: xpath.substring(xpath.lastIndexOf(&quot;/&quot;) + 1),
        })
      );
    }

    return errors;
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="459" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:459</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>xpath</td>
                                                    <td>
                                                            <code><ul>
<li>simple path to question</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="goToTarget"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>goToTarget</b></span>
                        <a href="#goToTarget"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (target: HTMLElement) {
    console.trace(&quot;scroll to target&quot;, target);
    if (target) {
      if (this.pages.active) {
        // Flip to page
        this.pages.flipToPageContaining($(target));
      }
      // check if the target has a form control
      if (target.closest(&quot;.calculation, .setvalue, .setgeopoint&quot;)) {
        // It is up to the apps to decide what to do with this event.
        target.dispatchEvent(events.GoToInvisible());
      }
      // check if the nearest question or group is irrelevant after page flip
      if (target.closest(&quot;.or-branch.disabled&quot;)) {
        // It is up to the apps to decide what to do with this event.
        target.dispatchEvent(events.GoToIrrelevant());
      }
      // Scroll to element
      target.scrollIntoView();
      // Focus on the first non .ignore form control
      // If the element is hidden (e.g. because it&#x27;s been replaced by a widget),
      // the focus event will not fire, so we also trigger an applyfocus event that widgets can listen for.
      const input &#x3D; target.querySelector&lt;HTMLInputElement&gt;(
        &quot;input:not(.ignore), textarea:not(.ignore), select:not(.ignore)&quot;
      );
      input.focus();
      input.dispatchEvent(events.ApplyFocus());
    }

    return !!target;
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1330" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1330</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Scrolls to an HTML question or group element, flips to the page it is on and focuses on the nearest form control.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>target</td>
                                                    <td>
                                                            <code><ul>
<li>An HTML question or group element to scroll to</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="grosslyViolateStandardComplianceByIgnoringCertainCalcs"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>grosslyViolateStandardComplianceByIgnoringCertainCalcs</b></span>
                        <a href="#grosslyViolateStandardComplianceByIgnoringCertainCalcs"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    const $culprit &#x3D; this.view.$.find(&#x27;[name$&#x3D;&quot;instanceID&quot;][data-calculate]&#x27;);
    if ($culprit.length &gt; 0) {
      $culprit.removeAttr(&quot;data-calculate&quot;);
    }
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="850" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:850</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>See <a href="https://groups.google.com/forum/?fromgroups=#!topic/opendatakit-developers/oBn7eQNQGTg">https://groups.google.com/forum/?fromgroups=#!topic/opendatakit-developers/oBn7eQNQGTg</a>
and <a href="http://code.google.com/p/opendatakit/issues/detail?id=706">http://code.google.com/p/opendatakit/issues/detail?id=706</a></p>
<p>This is using an aggressive name attribute selector to also find e.g. name=&quot;/../orx:meta/orx:instanceID&quot;, with
<em>ANY</em> namespace prefix.</p>
<p>Once the following is complete this function can and should be removed:</p>
<ol>
<li>ODK Collect starts supporting an instanceID preload item (or automatic handling of meta-&gt;instanceID without binding)</li>
<li>Pyxforms changes the instanceID binding from calculate to preload (or without binding)</li>
<li>Formhub has re-generated all stored XML forms from the stored XLS forms with the updated pyxforms</li>
</ol>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="init"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>init</b></span>
                        <a href="#init"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    let loadErrors &#x3D; [];
    const that &#x3D; this;

    initTimeLocalization(this.view.html);

    this.toc &#x3D; this.addModule(tocModule);
    this.pages &#x3D; this.addModule(pageModule);
    this.langs &#x3D; this.addModule(languageModule);
    this.progress &#x3D; this.addModule(progressModule);
    this.widgets &#x3D; this.addModule(widgetModule);
    this.preloads &#x3D; this.addModule(preloadModule);
    this.relevant &#x3D; this.addModule(relevantModule);
    this.repeats &#x3D; this.addModule(repeatModule);
    this.input &#x3D; this.addModule(inputHelper);
    this.output &#x3D; this.addModule(outputModule);
    this.itemset &#x3D; this.addModule(itemsetModule);
    this.calc &#x3D; this.addModule(calculationModule);
    this.required &#x3D; this.addModule(requiredModule);
    this.mask &#x3D; this.addModule(maskModule);
    this.readonly &#x3D; this.addModule(readonlyModule);

    // Handle odk-instance-first-load event
    this.model.events.addEventListener(events.InstanceFirstLoad().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Handle odk-new-repeat event before initializing repeats
    this.view.html.addEventListener(events.NewRepeat().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Handle xforms-value-changed
    this.view.html.addEventListener(events.XFormsValueChanged().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Before initializing form view and model, passthrough some model events externally
    // Because of instance-first-load actions, this should be done before the model is initialized. This is important for custom
    // applications that submit each individual value separately (opposed to a full XML model at the end).
    this.model.events.addEventListener(events.DataUpdate().type, (event) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.DataUpdate(event.detail));
    });

    // This probably does not need to be before model.init();
    this.model.events.addEventListener(events.Removed().type, (event) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.Removed(event.detail));
    });

    loadErrors &#x3D; loadErrors.concat(this.model.init());

    if (typeof this.model &#x3D;&#x3D;&#x3D; &quot;undefined&quot; || !(this.model instanceof FormModel)) {
      loadErrors.push(&quot;Form could not be initialized without a model.&quot;);

      return loadErrors;
    }

    try {
      this.preloads.init();

      // before widgets.init (as instanceID used in offlineFilepicker widget)
      // store the current instanceID as data on the form element so it can be easily accessed by e.g. widgets
      this.view.$.data({
        instanceID: this.model.instanceID,
      });

      // before calc.update!
      this.grosslyViolateStandardComplianceByIgnoringCertainCalcs();
      // before repeats.init to make sure the jr:repeat-count calculation has been evaluated
      this.calc.update();

      // before itemset.update
      this.langs.init(this.options.language);

      // before repeats.init so that template contains role&#x3D;&quot;page&quot; when applicable
      this.pages.init();

      // after radio button data-name setting (now done in XLST)
      let repeatsAdded &#x3D; 0;

      const tempHandlerAddRepeat &#x3D; () &#x3D;&gt; {
        repeatsAdded +&#x3D; 1;
      };

      this.view.html.addEventListener(events.AddRepeat().type, tempHandlerAddRepeat);

      this.repeatsInitialized &#x3D; true;
      this.repeats.init();

      // Recalculate after repeats are initialized. Previously this was performed in
      // &#x60;tempHandlerAddRepeat&#x60;, but recalculating them all at once is significantly faster.
      if (repeatsAdded &gt; 0) {
        this.calc.update({
          allRepeats: true,
          cloned: true,
        });

        this.all &#x3D; {};

        // Builds a cache of known repeat path prefixes &#x60;repeat.init&#x60;.
        // The cache is sorted by length, longest to shortest, to ensure
        // that lookups using this cache find the deepest nested repeat
        // for a given path.
        this.repeatPathPrefixes &#x3D; Array.from&lt;any&gt;(
          this.view.html.querySelectorAll(&quot;.or-repeat-info&quot;)
        )
          .map((element) &#x3D;&gt; &#x60;${element.dataset.name}/&#x60;)
          .sort((a, b) &#x3D;&gt; b.length - a.length);
      }

      this.view.html.removeEventListener(events.AddRepeat().type, tempHandlerAddRepeat);

      // after repeats.init, but before itemset.update
      this.output.update();

      // after repeats.init
      this.itemset.update();

      // after repeats.init
      this.setAllVals();

      this.readonly.update(); // after setAllVals();

      // after setAllVals, after repeats.init

      this.options.input &#x3D; this.input;
      this.options.pathToAbsolute &#x3D; this.pathToAbsolute.bind(this);
      this.options.evaluate &#x3D; this.model.evaluate.bind(this.model);
      this.options.getModelValue &#x3D; this.getModelValue.bind(this);
      this.widgetsInitialized &#x3D; this.widgets.init(null, this.options);

      // after widgets.init(), and after repeats.init(), and after pages.init()
      this.relevant.update();

      // after widgets init to make sure widget handlers are called before
      // after loading existing instance to not trigger an &#x27;edit&#x27; event
      this.setEventHandlers();

      // Update field calculations again to make sure that dependent
      // field values are calculated
      this.calc.update();

      this.required.update();

      this.mask.init();

      this.editStatus &#x3D; false;

      if (this.options.printRelevantOnly !&#x3D;&#x3D; false) {
        this.view.$.addClass(&quot;print-relevant-only&quot;);
      }

      setTimeout(() &#x3D;&gt; {
        that.progress.update();
      }, 0);

      this.initialized &#x3D; true;

      return loadErrors;
    } catch (e) {
      console.error(e);
      loadErrors.push(&#x60;${e.name}: ${e.message}&#x60;);
    }

    document.querySelector(&quot;body&quot;).scrollIntoView();

    return loadErrors;
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="283" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:283</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Function: init</p>
<p>Initializes the Form instance (XML Model and HTML View).</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="initialized"></a>
                    <span class="name">
                        <span ><b>initialized</b></span>
                        <a href="#initialized"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="64" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:64</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="input"></a>
                    <span class="name">
                        <span ><b>input</b></span>
                        <a href="#input"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="74" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:74</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isValid"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>isValid</b></span>
                        <a href="#isValid"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (node) {
    const invalidSelectors &#x3D; [&quot;.invalid-required&quot;, &quot;.invalid-relevant&quot;].concat(
      this.constraintClassesInvalid.map((cls) &#x3D;&gt; &#x60;.${cls}&#x60;)
    );
    if (node) {
      const question &#x3D; this.input.getWrapNode(node);
      const cls &#x3D; question.classList;

      return !invalidSelectors.some((selector) &#x3D;&gt; cls.contains(selector));
    }

    return !this.view.html.querySelector(invalidSelectors.join(&quot;, &quot;));
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1085" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1085</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Checks whether the question is not currently marked as invalid. If no argument is provided, it checks the whole form.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>node</td>
                                                    <td>
                                                            <code><ul>
<li>form control HTML element</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="itemset"></a>
                    <span class="name">
                        <span ><b>itemset</b></span>
                        <a href="#itemset"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="76" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:76</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="langs"></a>
                    <span class="name">
                        <span ><b>langs</b></span>
                        <a href="#langs"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="68" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:68</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="mask"></a>
                    <span class="name">
                        <span ><b>mask</b></span>
                        <a href="#mask"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="79" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:79</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="model"></a>
                    <span class="name">
                        <span ><b>model</b></span>
                        <a href="#model"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/Form.html" target="_self" >FormModel</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="59" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:59</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="nodePathToRepeatPath"></a>
                    <span class="name">
                        <span ><b>nodePathToRepeatPath</b></span>
                        <a href="#nodePathToRepeatPath"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>Record&lt;string | string | null&gt;</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>{}</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="89" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:89</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="nonRepeats"></a>
                    <span class="name">
                        <span ><b>nonRepeats</b></span>
                        <a href="#nonRepeats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>literal type</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="51" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:51</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="options"></a>
                    <span class="name">
                        <span ><b>options</b></span>
                        <a href="#options"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="../classes/Form.html" target="_self" >FormOptions</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="53" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:53</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="output"></a>
                    <span class="name">
                        <span ><b>output</b></span>
                        <a href="#output"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="75" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:75</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pageNavigationBlocked"></a>
                    <span class="name">
                        <span ><b>pageNavigationBlocked</b></span>
                        <a href="#pageNavigationBlocked"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="63" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:63</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pages"></a>
                    <span class="name">
                        <span ><b>pages</b></span>
                        <a href="#pages"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="67" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:67</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="pathToAbsolute"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>pathToAbsolute</b></span>
                        <a href="#pathToAbsolute"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (targetPath, contextPath) {
    let target;

    if (targetPath.indexOf(&quot;/&quot;) &#x3D;&#x3D;&#x3D; 0) {
      return targetPath;
    }

    // index is non-relevant (no positions in returned path)
    target &#x3D; this.model.evaluate(targetPath, &quot;node&quot;, contextPath, 0, true);

    return getXPath(target, &quot;instance&quot;, false);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1195" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1195</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>targetPath</td>
                                                    <td>
                                                            <code><ul>
<li>simple relative or absolute path</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>contextPath</td>
                                                    <td>
                                                            <code><ul>
<li>absolute context path</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="preloads"></a>
                    <span class="name">
                        <span ><b>preloads</b></span>
                        <a href="#preloads"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="71" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:71</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="progress"></a>
                    <span class="name">
                        <span ><b>progress</b></span>
                        <a href="#progress"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="69" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:69</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="readonly"></a>
                    <span class="name">
                        <span ><b>readonly</b></span>
                        <a href="#readonly"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="81" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:81</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="relevant"></a>
                    <span class="name">
                        <span ><b>relevant</b></span>
                        <a href="#relevant"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="72" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:72</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="repeatPathPrefixes"></a>
                    <span class="name">
                        <span ><b>repeatPathPrefixes</b></span>
                        <a href="#repeatPathPrefixes"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>string[] | null</code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>null</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="82" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:82</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="repeats"></a>
                    <span class="name">
                        <span ><b>repeats</b></span>
                        <a href="#repeats"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="73" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:73</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="repeatsInitialized"></a>
                    <span class="name">
                        <span ><b>repeatsInitialized</b></span>
                        <a href="#repeatsInitialized"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="62" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:62</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="repeatsPresent"></a>
                    <span class="name">
                        <span ><b>repeatsPresent</b></span>
                        <a href="#repeatsPresent"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="60" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:60</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="replaceChoiceNameFn"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>replaceChoiceNameFn</b></span>
                        <a href="#replaceChoiceNameFn"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (expr, resTypeStr, context, index, tryNative) {
    const choiceNames &#x3D; parseFunctionFromExpression(expr, &quot;jr:choice-name&quot;);

    choiceNames.forEach((choiceName) &#x3D;&gt; {
      const params &#x3D; choiceName[1];

      if (params.length &#x3D;&#x3D;&#x3D; 2) {
        let label &#x3D; &quot;&quot;;
        const value &#x3D; this.model.evaluate(params[0], resTypeStr, context, index, tryNative);
        let name &#x3D; stripQuotes(params[1]).trim();
        name &#x3D; name.startsWith(&quot;/&quot;) ? name : joinPath(context, name);
        const inputs &#x3D; [
          ...this.view.html.querySelectorAll(&#x60;[name&#x3D;&quot;${name}&quot;], [data-name&#x3D;&quot;${name}&quot;]&#x60;),
        ];
        const nodeName &#x3D; inputs.length ? inputs[0].nodeName.toLowerCase() : null;

        if (!value || !inputs.length) {
          label &#x3D; &quot;&quot;;
        } else if (nodeName &#x3D;&#x3D;&#x3D; &quot;select&quot;) {
          const found &#x3D; inputs.find((input) &#x3D;&gt;
            input.querySelector(&#x60;[value&#x3D;&quot;${CSS.escape(value)}&quot;]&#x60;)
          );
          label &#x3D; found ? found.querySelector(&#x60;[value&#x3D;&quot;${CSS.escape(value)}&quot;]&#x60;).textContent : &quot;&quot;;
        } else if (nodeName &#x3D;&#x3D;&#x3D; &quot;input&quot;) {
          const list &#x3D; inputs[0].getAttribute(&quot;list&quot;);

          if (!list) {
            const found &#x3D; inputs.find((input) &#x3D;&gt; input.getAttribute(&quot;value&quot;) &#x3D;&#x3D;&#x3D; value);
            const firstSiblingLabelEl &#x3D; found
              ? getSiblingElement(found, &quot;.option-label.active&quot;)
              : [];
            label &#x3D; firstSiblingLabelEl ? (firstSiblingLabelEl as Element).textContent : &quot;&quot;;
          } else {
            const firstSiblingListEl &#x3D; getSiblingElement(inputs[0], &#x60;datalist#${CSS.escape(list)}&#x60;);
            if (firstSiblingListEl) {
              const optionEl &#x3D; firstSiblingListEl.querySelector(&#x60;[data-value&#x3D;&quot;${value}&quot;]&#x60;);
              label &#x3D; optionEl ? optionEl.getAttribute(&quot;value&quot;) : &quot;&quot;;
            }
          }
        }

        expr &#x3D; expr.replace(choiceName[0], &#x60;&quot;${label}&quot;&#x60;);
      } else {
        throw new FormLogicError(
          &#x60;jr:choice-name function has incorrect number of parameters: ${choiceName[0]}&#x60;
        );
      }
    });

    return expr;
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="517" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:517</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Implements jr:choice-name
TODO: this needs to work for all expressions (relevants, constraints), now it only works for calculated items
Ideally this belongs in the form Model, but unfortunately it needs access to the view</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>expr</td>
                                                    <td>
                                                            <code><ul>
<li>XPath expression</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>resTypeStr</td>
                                                    <td>
                                                            <code><ul>
<li>type of result</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>context</td>
                                                    <td>
                                                            <code><ul>
<li>context path</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>index</td>
                                                    <td>
                                                            <code><ul>
<li>index of context</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>tryNative</td>
                                                    <td>
                                                            <code><ul>
<li>whether to try the native evaluator, i.e. if there is no risk it would create an incorrect result such as with date comparisons</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="required"></a>
                    <span class="name">
                        <span ><b>required</b></span>
                        <a href="#required"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="78" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:78</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="requiredTransformerVersion"></a>
                    <span class="name">
                        <span ><b>requiredTransformerVersion</b></span>
                        <a href="#requiredTransformerVersion"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>&quot;2.1.6&quot;</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="87" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:87</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Static property with required enketo-transformer version.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resetView"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>resetView</b></span>
                        <a href="#resetView"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    // form language selector was moved outside of &lt;form&gt; so has to be separately removed
    if (this.langs.formLanguages) {
      this.langs.formLanguages.remove();
    }
    this.view.html.replaceWith(this.view.clone);

    return document.querySelector(&quot;form.or&quot;);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="495" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:495</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Restores HTML form to pre-initialized state. It is meant to be called before re-initializing with
new Form ( .....) and form.init()
For this reason, it does not fix event handler, $form, formView.$ etc.!
It also does not affect the XML instance!</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setAllVals"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>setAllVals</b></span>
                        <a href="#setAllVals"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function ($group, groupIndex) {
    const that &#x3D; this;
    const selector &#x3D; $group &amp;&amp; $group.attr(&quot;name&quot;) ? $group.attr(&quot;name&quot;) : null;

    groupIndex &#x3D; typeof groupIndex !&#x3D;&#x3D; &quot;undefined&quot; ? groupIndex : null;

    this.model
      .node(selector, groupIndex)
      .getElements()
      .reduce((nodes, current) &#x3D;&gt; {
        const newNodes &#x3D; [...current.querySelectorAll(&quot;*&quot;)].filter(
          (n) &#x3D;&gt; n.children.length &#x3D;&#x3D;&#x3D; 0 &amp;&amp; n.textContent
        );

        return nodes.concat(newNodes);
      }, [])
      .forEach((element) &#x3D;&gt; {
        let value;
        let name;

        try {
          value &#x3D; element.textContent;
          name &#x3D; getXPath(element, &quot;instance&quot;);
          const index &#x3D; that.model.node(name).getElements().indexOf(element);
          const control &#x3D; that.input.find(name, index);
          if (control) {
            that.input.setVal(control, value, null);
            if (
              that.input.getXmlType(control) &#x3D;&#x3D;&#x3D; &quot;binary&quot; &amp;&amp;
              value.startsWith(&quot;jr://&quot;) &amp;&amp;
              element.getAttribute(&quot;src&quot;)
            ) {
              control.setAttribute(&quot;data-loaded-url&quot;, element.getAttribute(&quot;src&quot;));
            }
          }
        } catch (e) {
          console.error(e);
          // TODO: Test if this correctly adds to loadErrors
          // loadErrors.push( &#x27;Could not load input field value with name: &#x27; + name + &#x27; and value: &#x27; + value );
          throw new Error(
            &#x60;Could not load input field value with name: ${name} and value: ${value}&#x60;
          );
        }
      });
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="577" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:577</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Uses current state of model to set all the values in the form.
Since not all data nodes with a value have a corresponding input element,
we cycle through the HTML form elements and check for each form element whether data is available.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>$group</td>
                                                    <td>
                                                            <code><ul>
<li>group of elements for which form controls should be updated (with current model values)</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>groupIndex</td>
                                                    <td>
                                                            <code><ul>
<li>index of the group</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setEventHandlers"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>setEventHandlers</b></span>
                        <a href="#setEventHandlers"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    const that &#x3D; this;

    // Prevent default submission, e.g. when text field is filled in and Enter key is pressed
    this.view.$.attr(&quot;onsubmit&quot;, &quot;return false;&quot;);

    /*
     * The listener below catches both change and change.file events.
     * The .file namespace is used in the filepicker to avoid an infinite loop.
     *
     * Fields with the &quot;ignore&quot; class are dynamically added to the DOM in a widget and are supposed to be handled
     * by the widget itself, e.g. the search field in a geopoint widget. They should be ignored by the main engine.
     *
     * Readonly fields are not excluded because of this scenario:
     * 1. readonly field has a calculation
     * 2. readonly field becomes non-relevant (e.g. parent group with relevant)
     * 3. this clears value in view, which should propagate to model via &#x27;change&#x27; event
     */
    this.view.$.on(
      &quot;change.file&quot;,
      &quot;input:not(.ignore), select:not(.ignore), textarea:not(.ignore)&quot;,
      function () {
        const input &#x3D; this;
        const n &#x3D; {
          path: that.input.getName(input),
          inputType: that.input.getInputType(input),
          xmlType: that.input.getXmlType(input),
          val: that.input.getVal(input),
          index: that.input.getIndex(input),
        };

        // set file input values to the uniqified actual name of file (without c://fakepath or anything like that)
        if (
          n.val.length &gt; 0 &amp;&amp;
          n.inputType &#x3D;&#x3D;&#x3D; &quot;file&quot; &amp;&amp;
          input.files[0] &amp;&amp;
          input.files[0].size &gt; 0
        ) {
          n.val &#x3D; getFilename(input.files[0], input.dataset.filenamePostfix);
        }
        if (n.val.length &gt; 0 &amp;&amp; n.inputType &#x3D;&#x3D;&#x3D; &quot;drawing&quot;) {
          n.val &#x3D; getFilename(
            {
              name: n.val,
            },
            input.dataset.filenamePostfix
          );
        }

        const updated &#x3D; that.model.node(n.path, n.index).setVal(n.val, n.xmlType);

        if (updated) {
          that.validateInput(input).then(() &#x3D;&gt; {
            // after internal processing is completed
            input.dispatchEvent(events.XFormsValueChanged({ repeatIndex: n.index }));
          });
        }
      }
    );

    // doing this on the focus event may have little effect on performance, because nothing else is happening :)
    this.view.html.addEventListener(&quot;focusin&quot;, (event) &#x3D;&gt; {
      // update the form progress status
      this.progress.update(event.target);
    });

    this.view.html.addEventListener(events.FakeFocus().type, (event) &#x3D;&gt; {
      // update the form progress status
      this.progress.update(event.target);
    });

    this.model.events.addEventListener(events.DataUpdate().type, (event) &#x3D;&gt; {
      that.evaluationCascade.forEach((fn) &#x3D;&gt; {
        fn.call(that, event.detail);
      }, true);
      // edit is fired when the model changes after the form has been initialized
      that.editStatus &#x3D; true;
    });

    this.view.html.addEventListener(events.AddRepeat().type, (event) &#x3D;&gt; {
      const $clone &#x3D; $(event.target);

      // Set template-defined static defaults of added repeats in Form, setAllVals does not trigger change event
      this.setAllVals($clone, event.detail.repeatIndex);

      // Initialize calculations, relevant, itemset, required, output inside that repeat.
      this.evaluationCascade.forEach((fn) &#x3D;&gt; {
        fn.call(that, event.detail);
      });
      this.progress.update();
    });

    this.view.html.addEventListener(events.RemoveRepeat().type, () &#x3D;&gt; {
      this.progress.update();
    });

    this.view.html.addEventListener(events.ChangeLanguage().type, () &#x3D;&gt; {
      this.output.update();
    });

    this.view.$.find(&quot;.or-group &gt; h4&quot;).on(&quot;click&quot;, function () {
      // The resize trigger is to make sure canvas widgets start working.
      $(this).closest(&quot;.or-group&quot;).toggleClass(&quot;or-appearance-compact&quot;).trigger(&quot;resize&quot;);
    });
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="894" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:894</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>A big function that sets event handlers.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setInvalid"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>setInvalid</b></span>
                        <a href="#setInvalid"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (control, type &#x3D; &quot;constraint&quot;) {
    const wrap &#x3D; this.input.getWrapNode(control);

    if (!wrap) {
      // TODO: this condition occurs, at least in tests for itemsets, but we need find out how.
      return;
    }

    if (config.validatePage &#x3D;&#x3D;&#x3D; false &amp;&amp; this.isValid(control)) {
      this.blockPageNavigation();
    }

    wrap.classList.add(&#x60;invalid-${type}&#x60;);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1026" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1026</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Marks a question as invalid in the form UI.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>control</td>
                                                    <td>
                                                            <code><ul>
<li>form control HTML element</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>type</td>
                                                    <td>
                                                            <code><ul>
<li>One of &quot;constraint&quot;, &quot;required&quot; and &quot;relevant&quot;.</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setValid"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>setValid</b></span>
                        <a href="#setValid"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (control, type) {
    const wrap &#x3D; this.input.getWrapNode(control);

    if (!wrap) {
      // TODO: this condition occurs, at least in tests for itemsets, but we need find out how.
      return;
    }

    const classes &#x3D; type
      ? [&#x60;invalid-${type}&#x60;]
      : [...wrap.classList].filter((cl) &#x3D;&gt; cl.indexOf(&quot;invalid-&quot;) &#x3D;&#x3D;&#x3D; 0);
    wrap.classList.remove(...classes);
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1006" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1006</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Removes an invalid mark on a question in the form UI.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>control</td>
                                                    <td>
                                                            <code><ul>
<li>form control HTML element</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>type</td>
                                                    <td>
                                                            <code><ul>
<li>One of &quot;constraint&quot;, &quot;required&quot; and &quot;relevant&quot;.</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="toc"></a>
                    <span class="name">
                        <span ><b>toc</b></span>
                        <a href="#toc"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="66" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:66</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="updateValidityInUi"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>updateValidityInUi</b></span>
                        <a href="#updateValidityInUi"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (control, result) {
    const passed &#x3D; result.requiredValid !&#x3D;&#x3D; false &amp;&amp; result.constraintValid !&#x3D;&#x3D; false;

    // Update UI
    if (result.requiredValid &#x3D;&#x3D;&#x3D; false) {
      this.setValid(control, &quot;constraint&quot;);
      this.setInvalid(control, &quot;required&quot;);
    } else if (result.constraintValid &#x3D;&#x3D;&#x3D; false) {
      this.setValid(control, &quot;required&quot;);
      this.setInvalid(control, &quot;constraint&quot;);
    } else {
      this.setValid(control, &quot;constraint&quot;);
      this.setValid(control, &quot;required&quot;);
    }

    if (!passed) {
      control.dispatchEvent(events.Invalidated());
    }
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1046" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1046</a></div>
                        </td>
                    </tr>


                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>control</td>
                                                    <td>
                                                            <code><ul>
<li>form control HTML element</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                            <tr>
                                                    <td>result</td>
                                                    <td>
                                                            <code><ul>
<li>result object obtained from Nodeset.validate</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validate"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>validate</b></span>
                        <a href="#validate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>this.validateAll</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1129" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1129</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Alias of validateAll</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateAll"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>validateAll</b></span>
                        <a href="#validateAll"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function () {
    const that &#x3D; this;
    // to not delay validation unnecessarily we only clear non-relevants if necessary
    this.clearNonRelevant();

    return this.validateContent(this.view.$).then((valid) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.ValidationComplete());

      return valid;
    });
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1112" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1112</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Clears all non-relevant question values if necessary and then
validates all enabled input fields after first resetting everything as valid.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateContent"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>validateContent</b></span>
                        <a href="#validateContent"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function ($container) {
    const that &#x3D; this;
    const invalidSelector &#x3D; [&quot;.invalid-required&quot;, &quot;.invalid-relevant&quot;]
      .concat(this.constraintClassesInvalid.map((cls) &#x3D;&gt; &#x60;.${cls}&#x60;))
      .join(&quot;, &quot;);

    // can&#x27;t fire custom events on disabled elements therefore we set them all as valid
    $container
      .find(
        &quot;fieldset:disabled input, fieldset:disabled select, fieldset:disabled textarea, &quot; +
          &quot;input:disabled, select:disabled, textarea:disabled&quot;
      )
      .each(function () {
        that.setValid(this);
      });

    const validations &#x3D; $container
      .find(&quot;.question&quot;)
      .addBack(&quot;.question&quot;)
      .map(function () {
        // only trigger validate on first input and use a **pure CSS** selector (huge performance impact)
        const elem &#x3D; this.querySelector(
          &quot;input:not(.ignore):not(:disabled), select:not(.ignore):not(:disabled), textarea:not(.ignore):not(:disabled)&quot;
        );
        if (!elem) {
          return Promise.resolve();
        }

        return that.validateInput(elem);
      })
      .toArray();

    return Promise.all(validations)
      .then(() &#x3D;&gt; {
        const container &#x3D; $container[0];
        const firstError &#x3D; container.matches(invalidSelector)
          ? container
          : container.querySelector(invalidSelector);

        if (firstError) {
          that.goToTarget(firstError);
        }

        return !firstError;
      })
      .catch(
        () &#x3D;&gt;
          // fail whole-form validation if any of the question
          // validations threw.
          false
      );
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1137" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1137</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Validates all enabled input fields in the supplied container, after first resetting everything as valid.</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>$container</td>
                                                    <td>
                                                            <code><ul>
<li>HTML container element inside which to validate form controls</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validateInput"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>validateInput</b></span>
                        <a href="#validateInput"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (control) {
    if (!this.initialized) {
      return Promise.resolve();
    }
    const that &#x3D; this;
    let getValidationResult;
    // All properties, except for the **very expensive** index property
    // There is some scope for performance improvement by determining other properties when they
    // are needed, but that may not be so significant.
    const n &#x3D; {
      path: this.input.getName(control),
      inputType: this.input.getInputType(control),
      xmlType: this.input.getXmlType(control),
      enabled: this.input.isEnabled(control),
      constraint: this.input.getConstraint(control),
      calculation: this.input.getCalculation(control),
      required: this.input.getRequired(control),
      readonly: this.input.getReadonly(control),
      val: this.input.getVal(control),
    };
    // No need to validate, **nor send validation events**. Meant for simple empty &quot;notes&quot; only.
    if (n.readonly &amp;&amp; !n.val &amp;&amp; !n.required &amp;&amp; !n.constraint &amp;&amp; !n.calculation) {
      return Promise.resolve();
    }

    // The enabled check serves a purpose only when an input field itself is marked as enabled but its parent fieldset is not.
    // If an element is disabled mark it as valid (to undo a previously shown branch with fields marked as invalid).
    if (n.enabled &amp;&amp; n.inputType !&#x3D;&#x3D; &quot;hidden&quot;) {
      // Only now, will we determine the index.
      n[&quot;ind&quot;] &#x3D; this.input.getIndex(control);
      getValidationResult &#x3D; this.model
        .node(n.path, n[&quot;ind&quot;])
        .validate(n.constraint, n.required, n.xmlType);
    } else {
      getValidationResult &#x3D; Promise.resolve({
        requiredValid: true,
        constraintValid: true,
      });
    }

    return getValidationResult
      .then((result) &#x3D;&gt; {
        if (n.inputType !&#x3D;&#x3D; &quot;hidden&quot;) {
          this.updateValidityInUi(control, result);
        }

        return result;
      })
      .catch((e) &#x3D;&gt; {
        console.error(&quot;validation error&quot;, e);
        that.setInvalid(control, &quot;constraint&quot;);
        throw e;
      });
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="1220" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:1220</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Validates question values.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="validationUpdate"></a>
                    <span class="name">
                            <span class="modifier">Public</span>
                        <span ><b>validationUpdate</b></span>
                        <a href="#validationUpdate"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>function (updated: any &#x3D; {}) {
    if (config.validateContinuously &#x3D;&#x3D;&#x3D; true) {
      let upd &#x3D; { ...updated };
      if (updated.cloned) {
        /*
         * We don&#x27;t want requireds and constraints of questions in a newly created
         * repeat to be evaluated immediately after the repeat is created.
         * However, we do want constraints and requireds outside the repeat that
         * depend on e.g. the count() of repeats to be re-evaluated.
         * To achieve this we use a dirty trick and convert the &quot;cloned&quot; updated object
         * to a regular &quot;node&quot; updated object.
         */
        upd &#x3D; {
          nodes: updated.repeatPath.split(&quot;/&quot;).reverse().slice(0, 1),
        };
      }

      // Find all inputs that have a dependency on the changed node. Avoid duplicates with Set.
      const nodes &#x3D; new Set(this.getRelatedNodes(&quot;data-required&quot;, &quot;&quot;, upd).get());
      this.constraintAttributes.forEach((attr) &#x3D;&gt;
        this.getRelatedNodes(attr, &quot;&quot;, upd).get().forEach(nodes.add, nodes)
      );

      nodes.forEach(this.validateInput, this);
    }
  }</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="864" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:864</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>This re-validates questions that have a dependency on a question that has just been updated.</p>
<p>Note: it does not take care of re-validating a question itself after its value has changed due to a calculation update!</p>
</div>
                </td>
            </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description">
                                <b>Parameters :</b>
                                <table class="params">
                                    <thead>
                                        <tr>
                                            <td>Name</td>
                                                <td>Description</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                            <tr>
                                                    <td>updated</td>
                                                    <td>
                                                            <code><ul>
<li>object that contains information on updated nodes</li>
</ul>
</code>
                                                    </td>
                                            </tr>
                                    </tbody>
                                </table>
                        </div>
                    </td>
                </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="view"></a>
                    <span class="name">
                        <span ><b>view</b></span>
                        <a href="#view"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>    <code>literal type</code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="54" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:54</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="widgets"></a>
                    <span class="name">
                        <span ><b>widgets</b></span>
                        <a href="#widgets"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="70" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:70</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="widgetsInitialized"></a>
                    <span class="name">
                        <span ><b>widgetsInitialized</b></span>
                        <a href="#widgetsInitialized"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="61" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:61</a></div>
                        </td>
                    </tr>


        </tbody>
    </table>
</section>







            <section>
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="evaluationCascade"></a>
                        <span class="name"><b>evaluationCascade</b><a href="#evaluationCascade"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>evaluationCascade()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="126" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:126</a></div>
                                </td>
                            </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="recordName"></a>
                        <span class="name"><b>recordName</b><a href="#recordName"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>recordName()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="160" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:160</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>set</b><code>recordName(name)</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="163" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:163</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <table class="params">
                                            <thead>
                                                <tr>
                                                    <td>Name</td>
                                                    <td>Optional</td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <tr>
                                                            <td>name</td>
                                                    
                                                    
                                                        <td>
                                                                No
                                                        </td>
                                                        
                                                    </tr>
                                            </tbody>
                                        </table>
                                </div>
                                <div>
                                </div>
                                <div class="io-description">
                                    <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                                </div>
                        </td>
                    </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="editStatus"></a>
                        <span class="name"><b>editStatus</b><a href="#editStatus"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>editStatus()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="169" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:169</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>set</b><code>editStatus(status)</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="172" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:172</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <table class="params">
                                            <thead>
                                                <tr>
                                                    <td>Name</td>
                                                    <td>Optional</td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <tr>
                                                            <td>status</td>
                                                    
                                                    
                                                        <td>
                                                                No
                                                        </td>
                                                        
                                                    </tr>
                                            </tbody>
                                        </table>
                                </div>
                                <div>
                                </div>
                                <div class="io-description">
                                    <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                                </div>
                        </td>
                    </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="surveyName"></a>
                        <span class="name"><b>surveyName</b><a href="#surveyName"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>surveyName()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="182" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:182</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="instanceID"></a>
                        <span class="name"><b>instanceID</b><a href="#instanceID"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>instanceID()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="188" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:188</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="deprecatedID"></a>
                        <span class="name"><b>deprecatedID</b><a href="#deprecatedID"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>deprecatedID()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="194" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:194</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="instanceName"></a>
                        <span class="name"><b>instanceName</b><a href="#instanceName"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>instanceName()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="200" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:200</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="version"></a>
                        <span class="name"><b>version</b><a href="#version"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>version()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="206" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:206</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="encryptionKey"></a>
                        <span class="name"><b>encryptionKey</b><a href="#encryptionKey"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>encryptionKey()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="212" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:212</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="action"></a>
                        <span class="name"><b>action</b><a href="#action"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>action()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="218" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:218</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="method"></a>
                        <span class="name"><b>method</b><a href="#method"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>method()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="224" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:224</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="id"></a>
                        <span class="name"><b>id</b><a href="#id"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>id()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="230" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:230</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="constraintClassesInvalid"></a>
                        <span class="name"><b>constraintClassesInvalid</b><a href="#constraintClassesInvalid"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>constraintClassesInvalid()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="238" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:238</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>To facilitate forks that support multiple constraints per question</p>
</div>

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="constraintAttributes"></a>
                        <span class="name"><b>constraintAttributes</b><a href="#constraintAttributes"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>constraintAttributes()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="246" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:246</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>To facilitate forks that support multiple constraints per question</p>
</div>

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="languages"></a>
                        <span class="name"><b>languages</b><a href="#languages"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>languages()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="252" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:252</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="currentLanguage"></a>
                        <span class="name"><b>currentLanguage</b><a href="#currentLanguage"><span class="icon ion-ios-link"></span></a></span>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>get</b><code>currentLanguage()</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="258" class="link-to-prism">src/app/shared/components/template/components/odk-form/libs/enketo/js/form.ts:258</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">

                                <div>
                                </div>
                        </td>
                    </tr>

            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import &quot;./plugins&quot;;
import &quot;./extend&quot;;

import $ from &quot;jquery&quot;;

import config from &quot;../config&quot;;
import calculationModule from &quot;./calculate&quot;;
import { closestAncestorUntil, getChild, getSiblingElement, getXPath } from &quot;./dom-utils&quot;;
import events from &quot;./event&quot;;
import { t } from &quot;./fake-translator&quot;;
import FormLogicError from &quot;./form-logic-error&quot;;
import { FormModel } from &quot;./form-model&quot;;
import { initTimeLocalization } from &quot;./format&quot;;
import inputHelper from &quot;./input&quot;;
import itemsetModule from &quot;./itemset&quot;;
import languageModule from &quot;./language&quot;;
import maskModule from &quot;./mask&quot;;
import outputModule from &quot;./output&quot;;
import pageModule from &quot;./page&quot;;
import preloadModule from &quot;./preload&quot;;
import progressModule from &quot;./progress&quot;;
import readonlyModule from &quot;./readonly&quot;;
import relevantModule from &quot;./relevant&quot;;
import repeatModule from &quot;./repeat&quot;;
import requiredModule from &quot;./required&quot;;
import { callOnIdle } from &quot;./timers&quot;;
import tocModule from &quot;./toc&quot;;
import type { FormDataObj } from &quot;./type-def&quot;;
import { getFilename, joinPath, parseFunctionFromExpression, stripQuotes } from &quot;./utils&quot;;
import widgetModule from &quot;./widgets-controller&quot;;

export type FormOptions &#x3D; {
  /**
   * Overrides the default languages rules of the XForm itself. Pass any valid and present-in-the-form IANA subtag string, e.g. &#x60;ar&#x60;.
   */
  language?: string | undefined;
  /**
   * If &#x60;printRelevantOnly&#x60; is set to &#x60;true&#x60;
   * or not set at all, printing the form only includes what is visible, ie. all the
   * groups and questions that do not have a &#x60;relevant&#x60; expression or for which the
   * expression evaluates to &#x60;true&#x60;.
   */
  printRelevantOnly?: boolean | undefined;
};
export type ValidateInputResolution &#x3D; {
  requiredValid: boolean;
  constraintValid: boolean;
};

class Form {
  nonRepeats: {};
  all: {};
  options: FormOptions;
  view: {
    $: any;
    html: HTMLElement;
    clone: Node;
  };
  model: FormModel;
  repeatsPresent: boolean;
  widgetsInitialized: boolean;
  repeatsInitialized: boolean;
  pageNavigationBlocked: boolean;
  initialized: boolean;
  // imported modules
  toc: any;
  pages: any;
  langs: any;
  progress: any;
  widgets: any;
  preloads: any;
  relevant: any;
  repeats: any;
  input: any;
  output: any;
  itemset: any;
  calc: any;
  required: any;
  mask: any;
  //
  readonly: any;
  repeatPathPrefixes: string[] | null &#x3D; null;

  /**
   * Static property with required enketo-transformer version.
   */
  requiredTransformerVersion &#x3D; &quot;2.1.6&quot;;

  nodePathToRepeatPath: Record&lt;string, string | null&gt; &#x3D; {};

  evaluationCascadeAdditions: any[] &#x3D; [];

  /**
   * Most methods are prototype method to facilitate customizations outside of enketo-core.
   *
   * @param {Element} formEl - HTML form element (a product of Enketo Transformer after transforming a valid ODK XForm)
   * @param {FormDataObj} data - Data object containing XML model, (partial) XML instance-to-load, external data and flag about whether instance-to-load has already been submitted before.
   * @param {FormOptions} [options]
   * @class
   */
  constructor(formEl: HTMLElement, data: FormDataObj[&quot;modelStr&quot;], options: FormOptions) {
    const $form &#x3D; $(formEl);
    if (typeof formEl &#x3D;&#x3D;&#x3D; &quot;string&quot;) {
      console.warn(&quot;Form instantiation using a selector&quot;, &quot;a HTML &lt;form&gt; element&quot;);
      formEl &#x3D; $form[0];
    }

    this.nonRepeats &#x3D; {};
    this.all &#x3D; {};
    this.options &#x3D; typeof options !&#x3D;&#x3D; &quot;object&quot; ? {} : options;

    this.view &#x3D; {
      $: $form,
      html: formEl,
      clone: formEl.cloneNode(true),
    };
    this.model &#x3D; new FormModel(data);
    console.log(&quot;model&quot;, this.model);
    this.repeatsPresent &#x3D; !!this.view.html.querySelector(&quot;.or-repeat&quot;);
    this.widgetsInitialized &#x3D; false;
    this.repeatsInitialized &#x3D; false;
    this.pageNavigationBlocked &#x3D; false;
    this.initialized &#x3D; false;
  }

  get evaluationCascade() {
    const baseEvaluationCascade &#x3D; [
      this.calc.update.bind(this.calc),
      this.repeats.countUpdate.bind(this.repeats),
      this.relevant.update.bind(this.relevant),
      this.output.update.bind(this.output),
      this.itemset.update.bind(this.itemset),
      this.required.update.bind(this.required),
      this.readonly.update.bind(this.readonly),
      this.validationUpdate,
    ];

    if (this.evaluationCascadeAdditions.length &gt; 0) {
      baseEvaluationCascade.push(function (...args) {
        for (const fn of this.evaluationCascadeAdditions) {
          fn.apply(this, args);
        }
      });
    }

    if (config.experimentalOptimizations.computeAsync) {
      return baseEvaluationCascade.map(
        (fn) &#x3D;&gt;
          function (...args) {
            callOnIdle(() &#x3D;&gt; fn.apply(this, args));
          }
      );
    }

    return baseEvaluationCascade;
  }
  /**
   * @type {string}
   */
  get recordName() {
    return this.view.$.attr(&quot;name&quot;);
  }
  set recordName(name) {
    this.view.$.attr(&quot;name&quot;, name);
  }
  /**
   * @type {boolean}
   */
  get editStatus() {
    return this.view.html.dataset.edited &#x3D;&#x3D;&#x3D; &quot;true&quot;;
  }
  set editStatus(status) {
    // only trigger edit event once
    if (status &amp;&amp; status !&#x3D;&#x3D; this.editStatus) {
      this.view.html.dispatchEvent(events.Edited());
    }
    this.view.html.dataset.edited &#x3D; status as any;
  }
  /**
   * @type {string}
   */
  get surveyName() {
    return this.view.$.find(&quot;#form-title&quot;).text();
  }
  /**
   * @type {string}
   */
  get instanceID() {
    return this.model.instanceID;
  }
  /**
   * @type {string}
   */
  get deprecatedID() {
    return this.model.deprecatedID;
  }
  /**
   * @type {string}
   */
  get instanceName() {
    return this.model.instanceName;
  }
  /**
   * @type {string}
   */
  get version() {
    return this.model.version;
  }
  /**
   * @type {string}
   */
  get encryptionKey() {
    return this.view.$.data(&quot;base64rsapublickey&quot;);
  }
  /**
   * @type {string}
   */
  get action() {
    return this.view.$.attr(&quot;action&quot;);
  }
  /**
   * @type {string}
   */
  get method() {
    return this.view.$.attr(&quot;method&quot;);
  }
  /**
   * @type {string}
   */
  get id() {
    return this.view.html.dataset.formId;
  }
  /**
   * To facilitate forks that support multiple constraints per question
   *
   * @type {Array&lt;string&gt;}
   */
  get constraintClassesInvalid() {
    return [&quot;invalid-constraint&quot;];
  }
  /**
   * To facilitate forks that support multiple constraints per question
   *
   * @type {Array&lt;string&gt;}
   */
  get constraintAttributes() {
    return [&quot;data-constraint&quot;];
  }
  /**
   * @type {Array&lt;string&gt;}
   */
  get languages() {
    return this.langs.languagesUsed;
  }
  /**
   * @type {string}
   */
  get currentLanguage() {
    return this.langs.currentLanguage;
  }

  /**
   * Returns a module and adds the form property to it.
   *
   * @param {object} module - Enketo Core module
   * @return {object} updated module
   */
  public addModule &#x3D; function (module) {
    return Object.create(module, {
      form: {
        value: this,
      },
    });
  };

  /**
   * Function: init
   *
   * Initializes the Form instance (XML Model and HTML View).
   *
   * @return {Array&lt;string&gt;} List of initialization errors.
   */
  public init &#x3D; function () {
    let loadErrors &#x3D; [];
    const that &#x3D; this;

    initTimeLocalization(this.view.html);

    this.toc &#x3D; this.addModule(tocModule);
    this.pages &#x3D; this.addModule(pageModule);
    this.langs &#x3D; this.addModule(languageModule);
    this.progress &#x3D; this.addModule(progressModule);
    this.widgets &#x3D; this.addModule(widgetModule);
    this.preloads &#x3D; this.addModule(preloadModule);
    this.relevant &#x3D; this.addModule(relevantModule);
    this.repeats &#x3D; this.addModule(repeatModule);
    this.input &#x3D; this.addModule(inputHelper);
    this.output &#x3D; this.addModule(outputModule);
    this.itemset &#x3D; this.addModule(itemsetModule);
    this.calc &#x3D; this.addModule(calculationModule);
    this.required &#x3D; this.addModule(requiredModule);
    this.mask &#x3D; this.addModule(maskModule);
    this.readonly &#x3D; this.addModule(readonlyModule);

    // Handle odk-instance-first-load event
    this.model.events.addEventListener(events.InstanceFirstLoad().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Handle odk-new-repeat event before initializing repeats
    this.view.html.addEventListener(events.NewRepeat().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Handle xforms-value-changed
    this.view.html.addEventListener(events.XFormsValueChanged().type, (event) &#x3D;&gt; {
      this.calc.performAction(&quot;setvalue&quot;, event);
      this.calc.performAction(&quot;setgeopoint&quot;, event);
    });

    // Before initializing form view and model, passthrough some model events externally
    // Because of instance-first-load actions, this should be done before the model is initialized. This is important for custom
    // applications that submit each individual value separately (opposed to a full XML model at the end).
    this.model.events.addEventListener(events.DataUpdate().type, (event) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.DataUpdate(event.detail));
    });

    // This probably does not need to be before model.init();
    this.model.events.addEventListener(events.Removed().type, (event) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.Removed(event.detail));
    });

    loadErrors &#x3D; loadErrors.concat(this.model.init());

    if (typeof this.model &#x3D;&#x3D;&#x3D; &quot;undefined&quot; || !(this.model instanceof FormModel)) {
      loadErrors.push(&quot;Form could not be initialized without a model.&quot;);

      return loadErrors;
    }

    try {
      this.preloads.init();

      // before widgets.init (as instanceID used in offlineFilepicker widget)
      // store the current instanceID as data on the form element so it can be easily accessed by e.g. widgets
      this.view.$.data({
        instanceID: this.model.instanceID,
      });

      // before calc.update!
      this.grosslyViolateStandardComplianceByIgnoringCertainCalcs();
      // before repeats.init to make sure the jr:repeat-count calculation has been evaluated
      this.calc.update();

      // before itemset.update
      this.langs.init(this.options.language);

      // before repeats.init so that template contains role&#x3D;&quot;page&quot; when applicable
      this.pages.init();

      // after radio button data-name setting (now done in XLST)
      let repeatsAdded &#x3D; 0;

      const tempHandlerAddRepeat &#x3D; () &#x3D;&gt; {
        repeatsAdded +&#x3D; 1;
      };

      this.view.html.addEventListener(events.AddRepeat().type, tempHandlerAddRepeat);

      this.repeatsInitialized &#x3D; true;
      this.repeats.init();

      // Recalculate after repeats are initialized. Previously this was performed in
      // &#x60;tempHandlerAddRepeat&#x60;, but recalculating them all at once is significantly faster.
      if (repeatsAdded &gt; 0) {
        this.calc.update({
          allRepeats: true,
          cloned: true,
        });

        this.all &#x3D; {};

        // Builds a cache of known repeat path prefixes &#x60;repeat.init&#x60;.
        // The cache is sorted by length, longest to shortest, to ensure
        // that lookups using this cache find the deepest nested repeat
        // for a given path.
        this.repeatPathPrefixes &#x3D; Array.from&lt;any&gt;(
          this.view.html.querySelectorAll(&quot;.or-repeat-info&quot;)
        )
          .map((element) &#x3D;&gt; &#x60;${element.dataset.name}/&#x60;)
          .sort((a, b) &#x3D;&gt; b.length - a.length);
      }

      this.view.html.removeEventListener(events.AddRepeat().type, tempHandlerAddRepeat);

      // after repeats.init, but before itemset.update
      this.output.update();

      // after repeats.init
      this.itemset.update();

      // after repeats.init
      this.setAllVals();

      this.readonly.update(); // after setAllVals();

      // after setAllVals, after repeats.init

      this.options.input &#x3D; this.input;
      this.options.pathToAbsolute &#x3D; this.pathToAbsolute.bind(this);
      this.options.evaluate &#x3D; this.model.evaluate.bind(this.model);
      this.options.getModelValue &#x3D; this.getModelValue.bind(this);
      this.widgetsInitialized &#x3D; this.widgets.init(null, this.options);

      // after widgets.init(), and after repeats.init(), and after pages.init()
      this.relevant.update();

      // after widgets init to make sure widget handlers are called before
      // after loading existing instance to not trigger an &#x27;edit&#x27; event
      this.setEventHandlers();

      // Update field calculations again to make sure that dependent
      // field values are calculated
      this.calc.update();

      this.required.update();

      this.mask.init();

      this.editStatus &#x3D; false;

      if (this.options.printRelevantOnly !&#x3D;&#x3D; false) {
        this.view.$.addClass(&quot;print-relevant-only&quot;);
      }

      setTimeout(() &#x3D;&gt; {
        that.progress.update();
      }, 0);

      this.initialized &#x3D; true;

      return loadErrors;
    } catch (e) {
      console.error(e);
      loadErrors.push(&#x60;${e.name}: ${e.message}&#x60;);
    }

    document.querySelector(&quot;body&quot;).scrollIntoView();

    return loadErrors;
  };

  /**
   * @param {string} xpath - simple path to question
   * @return {Array&lt;string&gt;} A list of errors originated from &#x60;goToTarget&#x60;. Empty if everything went fine.
   */
  public goTo &#x3D; function (xpath) {
    const errors &#x3D; [];
    if (!this.goToTarget(this.getGoToTarget(xpath))) {
      errors.push(
        t(&quot;alert.gotonotfound.msg&quot;, {
          path: xpath.substring(xpath.lastIndexOf(&quot;/&quot;) + 1),
        })
      );
    }

    return errors;
  };

  /**
   * Obtains a string of primary instance.
   *
   * @param {{include: boolean}} [include] - Optional object items to exclude if false
   * @return {string} XML string of primary instance
   */
  public getDataStr &#x3D; function (include: any &#x3D; {}) {
    // By default everything is included
    if (include.irrelevant &#x3D;&#x3D;&#x3D; false) {
      return this.getDataStrWithoutIrrelevantNodes();
    }

    return this.model.getStr();
  };

  /**
   * Restores HTML form to pre-initialized state. It is meant to be called before re-initializing with
   * new Form ( .....) and form.init()
   * For this reason, it does not fix event handler, $form, formView.$ etc.!
   * It also does not affect the XML instance!
   *
   * @return {Element} the new form element
   */
  public resetView &#x3D; function () {
    // form language selector was moved outside of &lt;form&gt; so has to be separately removed
    if (this.langs.formLanguages) {
      this.langs.formLanguages.remove();
    }
    this.view.html.replaceWith(this.view.clone);

    return document.querySelector(&quot;form.or&quot;);
  };

  /**
   * Implements jr:choice-name
   * TODO: this needs to work for all expressions (relevants, constraints), now it only works for calculated items
   * Ideally this belongs in the form Model, but unfortunately it needs access to the view
   *
   * @param {string} expr - XPath expression
   * @param {string} resTypeStr - type of result
   * @param {string} context - context path
   * @param {number} index - index of context
   * @param {boolean} tryNative - whether to try the native evaluator, i.e. if there is no risk it would create an incorrect result such as with date comparisons
   * @return {string} updated expression
   */
  public replaceChoiceNameFn &#x3D; function (expr, resTypeStr, context, index, tryNative) {
    const choiceNames &#x3D; parseFunctionFromExpression(expr, &quot;jr:choice-name&quot;);

    choiceNames.forEach((choiceName) &#x3D;&gt; {
      const params &#x3D; choiceName[1];

      if (params.length &#x3D;&#x3D;&#x3D; 2) {
        let label &#x3D; &quot;&quot;;
        const value &#x3D; this.model.evaluate(params[0], resTypeStr, context, index, tryNative);
        let name &#x3D; stripQuotes(params[1]).trim();
        name &#x3D; name.startsWith(&quot;/&quot;) ? name : joinPath(context, name);
        const inputs &#x3D; [
          ...this.view.html.querySelectorAll(&#x60;[name&#x3D;&quot;${name}&quot;], [data-name&#x3D;&quot;${name}&quot;]&#x60;),
        ];
        const nodeName &#x3D; inputs.length ? inputs[0].nodeName.toLowerCase() : null;

        if (!value || !inputs.length) {
          label &#x3D; &quot;&quot;;
        } else if (nodeName &#x3D;&#x3D;&#x3D; &quot;select&quot;) {
          const found &#x3D; inputs.find((input) &#x3D;&gt;
            input.querySelector(&#x60;[value&#x3D;&quot;${CSS.escape(value)}&quot;]&#x60;)
          );
          label &#x3D; found ? found.querySelector(&#x60;[value&#x3D;&quot;${CSS.escape(value)}&quot;]&#x60;).textContent : &quot;&quot;;
        } else if (nodeName &#x3D;&#x3D;&#x3D; &quot;input&quot;) {
          const list &#x3D; inputs[0].getAttribute(&quot;list&quot;);

          if (!list) {
            const found &#x3D; inputs.find((input) &#x3D;&gt; input.getAttribute(&quot;value&quot;) &#x3D;&#x3D;&#x3D; value);
            const firstSiblingLabelEl &#x3D; found
              ? getSiblingElement(found, &quot;.option-label.active&quot;)
              : [];
            label &#x3D; firstSiblingLabelEl ? (firstSiblingLabelEl as Element).textContent : &quot;&quot;;
          } else {
            const firstSiblingListEl &#x3D; getSiblingElement(inputs[0], &#x60;datalist#${CSS.escape(list)}&#x60;);
            if (firstSiblingListEl) {
              const optionEl &#x3D; firstSiblingListEl.querySelector(&#x60;[data-value&#x3D;&quot;${value}&quot;]&#x60;);
              label &#x3D; optionEl ? optionEl.getAttribute(&quot;value&quot;) : &quot;&quot;;
            }
          }
        }

        expr &#x3D; expr.replace(choiceName[0], &#x60;&quot;${label}&quot;&#x60;);
      } else {
        throw new FormLogicError(
          &#x60;jr:choice-name function has incorrect number of parameters: ${choiceName[0]}&#x60;
        );
      }
    });

    return expr;
  };

  /**
   * Uses current state of model to set all the values in the form.
   * Since not all data nodes with a value have a corresponding input element,
   * we cycle through the HTML form elements and check for each form element whether data is available.
   *
   * @param {jQuery} $group - group of elements for which form controls should be updated (with current model values)
   * @param {number} groupIndex - index of the group
   */
  public setAllVals &#x3D; function ($group, groupIndex) {
    const that &#x3D; this;
    const selector &#x3D; $group &amp;&amp; $group.attr(&quot;name&quot;) ? $group.attr(&quot;name&quot;) : null;

    groupIndex &#x3D; typeof groupIndex !&#x3D;&#x3D; &quot;undefined&quot; ? groupIndex : null;

    this.model
      .node(selector, groupIndex)
      .getElements()
      .reduce((nodes, current) &#x3D;&gt; {
        const newNodes &#x3D; [...current.querySelectorAll(&quot;*&quot;)].filter(
          (n) &#x3D;&gt; n.children.length &#x3D;&#x3D;&#x3D; 0 &amp;&amp; n.textContent
        );

        return nodes.concat(newNodes);
      }, [])
      .forEach((element) &#x3D;&gt; {
        let value;
        let name;

        try {
          value &#x3D; element.textContent;
          name &#x3D; getXPath(element, &quot;instance&quot;);
          const index &#x3D; that.model.node(name).getElements().indexOf(element);
          const control &#x3D; that.input.find(name, index);
          if (control) {
            that.input.setVal(control, value, null);
            if (
              that.input.getXmlType(control) &#x3D;&#x3D;&#x3D; &quot;binary&quot; &amp;&amp;
              value.startsWith(&quot;jr://&quot;) &amp;&amp;
              element.getAttribute(&quot;src&quot;)
            ) {
              control.setAttribute(&quot;data-loaded-url&quot;, element.getAttribute(&quot;src&quot;));
            }
          }
        } catch (e) {
          console.error(e);
          // TODO: Test if this correctly adds to loadErrors
          // loadErrors.push( &#x27;Could not load input field value with name: &#x27; + name + &#x27; and value: &#x27; + value );
          throw new Error(
            &#x60;Could not load input field value with name: ${name} and value: ${value}&#x60;
          );
        }
      });
  };

  /**
   * @param {jQuery} $control - HTML form control
   * @return {string|undefined} Value
   */
  public getModelValue &#x3D; function ($control) {
    const control &#x3D; $control[0];
    const path &#x3D; this.input.getName(control);
    const index &#x3D; this.input.getIndex(control);

    return this.model.node(path, index).getVal();
  };

  /**
   * Finds nodes that have attributes with XPath expressions that refer to particular XML elements.
   *
   * @param {string} attr - The attribute name to search for
   * @param {string} [filter] - The optional filter to append to each selector
   * @param {UpdatedDataNodes} updated - object that contains information on updated nodes
   * @return {jQuery} - A jQuery collection of elements
   */
  public getRelatedNodes &#x3D; function (attr, filter, updated) {
    let repeatControls &#x3D; null;
    let controls;
    updated &#x3D; updated || {};
    filter &#x3D; filter || &quot;&quot;;

    const { allRepeats, cloned, repeatPath } &#x3D; updated;

    // The collection of non-repeat inputs, calculations and groups is cached (unchangeable)
    if (!allRepeats &amp;&amp; !this.nonRepeats[attr]) {
      controls &#x3D; [...this.view.html.querySelectorAll(&#x60;:not(.or-repeat-info)[${attr}]&#x60;)].filter(
        (el) &#x3D;&gt; !el.closest(&quot;.or-repeat&quot;)
      );
      this.nonRepeats[attr] &#x3D; this.filterRadioCheckSiblings(controls);
    }

    if (allRepeats) {
      const controls &#x3D; [...this.view.html.querySelectorAll(&#x60;form.or .or-repeat [${attr}]&#x60;)];
      repeatControls &#x3D; this.filterRadioCheckSiblings(controls);
    } else if (typeof repeatPath !&#x3D;&#x3D; &quot;undefined&quot; &amp;&amp; updated.repeatIndex &gt;&#x3D; 0) {
      // If the updated node is inside a repeat (and there are multiple repeats present)
      const repeatEl &#x3D; [...this.view.html.querySelectorAll(&#x60;.or-repeat[name&#x3D;&quot;${repeatPath}&quot;]&#x60;)][
        updated.repeatIndex
      ];
      controls &#x3D; repeatEl ? [...repeatEl.querySelectorAll(&#x60;[${attr}]&#x60;)] : [];
      repeatControls &#x3D; this.filterRadioCheckSiblings(controls);
    }

    // If a new repeat was created, update the cached collection of all form controls with that attribute
    // If a repeat was deleted (updated.repeatPath &amp;&amp; !updated.cloned), rebuild cache.
    // Exclude outputs from the cache, because outputs can be added via itemsets (in labels).
    if (!this.all[attr] || (repeatPath &amp;&amp; !cloned) || filter &#x3D;&#x3D;&#x3D; &quot;.or-output&quot;) {
      // (re)build the cache
      // However, if repeats have not been initialized exclude nodes inside a repeat until the first repeat has been added during repeat initialization.
      // The default view repeat will be removed during initialization (and stored as template), before it is re-added, if necessary.
      // We need to avoid adding these fields to the initial cache,
      // so we don&#x27;t waste time evaluating logic, and don&#x27;t have to rebuild the cache after repeats have been initialized.
      this.all[attr] &#x3D; this.repeatsInitialized
        ? this.filterRadioCheckSiblings([...this.view.html.querySelectorAll(&#x60;[${attr}]&#x60;)])
        : this.nonRepeats[attr];
    } else if (cloned &amp;&amp; repeatControls) {
      // update the cache
      this.all[attr] &#x3D; this.all[attr].concat(repeatControls);
    }

    /**
     * If the update was triggered from a repeat, it improves performance (a lot)
     * to exclude all those repeats that did not trigger it...
     * However, this will break if people are referring to nodes in other
     * repeats such as with /path/to/repeat[3]/node, /path/to/repeat[position() &#x3D; 3]/node or indexed-repeat(/path/to/repeat/node, /path/to/repeat, 3).
     * We accept that for now.
     * */
    let collection;
    if (repeatControls) {
      // The non-repeat fields have to be added too, e.g. to update a calculated item with count(to/repeat/node) at the top level
      collection &#x3D; this.nonRepeats[attr].concat(repeatControls);
    } else {
      collection &#x3D; this.all[attr];
    }

    let selector &#x3D; [];
    // Add selectors based on specific changed nodes
    if (!updated.nodes || updated.nodes.length &#x3D;&#x3D;&#x3D; 0) {
      if (repeatControls !&#x3D; null &amp;&amp; cloned &amp;&amp; filter &#x3D;&#x3D;&#x3D; &quot;.itemset-template&quot;) {
        selector &#x3D; [&#x60;.or-repeat[name&#x3D;&quot;${repeatPath}&quot;] ${filter}[${attr}]&#x60;];
      } else {
        selector &#x3D; [&#x60;${filter}[${attr}]&#x60;];
      }
    } else {
      updated.nodes.forEach((node) &#x3D;&gt; {
        selector &#x3D; selector.concat(this.getQuerySelectorsForLogic(filter, attr, node));
      });
      // add all the paths that use the /* selector at end of path
      selector &#x3D; selector.concat(this.getQuerySelectorsForLogic(filter, attr, &quot;*&quot;));
    }

    const selectorStr &#x3D; selector.join(&quot;, &quot;);
    collection &#x3D; selectorStr ? collection.filter((el) &#x3D;&gt; el.matches(selectorStr)) : collection;

    // TODO: exclude descendents of disabled elements? .find( &#x27;:not(:disabled) span.active&#x27; )
    // TODO: remove jQuery wrapper, just return array of elements
    return $(collection);
  };

  /**
   * @param {Array&lt;Element&gt;} controls - radiobutton/checkbox HTML input elements
   * @return {Array&lt;Element&gt;} filtered controls without any sibling radiobuttons and checkboxes (only the first)
   */
  public filterRadioCheckSiblings &#x3D; (controls) &#x3D;&gt; {
    const wrappers &#x3D; [];

    return controls.filter((control) &#x3D;&gt; {
      // TODO: can this be further performance-optimized?
      const wrapper &#x3D;
        control.type &#x3D;&#x3D;&#x3D; &quot;radio&quot; || control.type &#x3D;&#x3D;&#x3D; &quot;checkbox&quot;
          ? closestAncestorUntil(control, &quot;.option-wrapper&quot;, &quot;.question&quot;)
          : null;
      // Filter out duplicate radiobuttons and checkboxes
      if (wrapper) {
        if (wrappers.includes(wrapper)) {
          return false;
        }
        wrappers.push(wrapper);
      }

      return true;
    });
  };

  /**
   * Crafts an optimized selector for element attributes that contain an expression with a target node name.
   *
   * @param {string} filter - The filter to use
   * @param {string} attr - The attribute to target
   * @param {string} nodeName - The XML nodeName to find
   * @return {string} The selector
   */
  public getQuerySelectorsForLogic &#x3D; (filter, attr, nodeName) &#x3D;&gt; [
    // The target node name is ALWAYS at the END of a path inside the expression.
    // #1: followed by space
    &#x60;${filter}[${attr}*&#x3D;&quot;/${nodeName} &quot;]&#x60;,
    // #2: followed by )
    &#x60;${filter}[${attr}*&#x3D;&quot;/${nodeName})&quot;]&#x60;,
    // #3: followed by , if used as first parameter of multiple parameters
    &#x60;${filter}[${attr}*&#x3D;&quot;/${nodeName},&quot;]&#x60;,
    // #4: at the end of an expression
    &#x60;${filter}[${attr}$&#x3D;&quot;/${nodeName}&quot;]&#x60;,
    // #5: followed by ] (used in itemset filters)
    &#x60;${filter}[${attr}*&#x3D;&quot;/${nodeName}]&quot;]&#x60;,
    // #6: followed by [ (used when filtering nodes in repeat instances)
    &#x60;${filter}[${attr}*&#x3D;&quot;/${nodeName}[&quot;]&#x60;,
  ];

  /**
   * Obtains the XML primary instance as string without nodes that have a relevant
   * that evaluates to false.
   *
   * Though this function may be slow it is slow when it doesn&#x27;t matter much (upon saving). The
   * alternative is to add some logic to relevant.update to mark irrelevant nodes in the model
   * but that would slow down form loading and form traversal when it does matter.
   *
   * @return {string} Data string
   */
  public getDataStrWithoutIrrelevantNodes &#x3D; function () {
    const that &#x3D; this;
    const modelClone &#x3D; new FormModel(this.model.getStr());
    modelClone.init();

    // Since we are removing nodes, we need to go in reverse order to make sure
    // the indices are still correct!
    this.getRelatedNodes(&quot;data-relevant&quot;)
      .reverse()
      .each(function () {
        const node &#x3D; this;
        const relevant &#x3D; that.input.getRelevant(node);
        const index &#x3D; that.input.getIndex(node);
        const path &#x3D; that.input.getName(node);
        let target;

        /*
         * Copied from relevant.js:
         *
         * If the relevant is placed on a group and that group contains repeats with the same name,
         * but currently has 0 repeats, the context will not be available.
         */
        if (
          getChild(node, &#x60;.or-repeat-info[data-name&#x3D;&quot;${path}&quot;]&#x60;) &amp;&amp;
          !getChild(node, &#x60;.or-repeat[name&#x3D;&quot;${path}&quot;]&#x60;)
        ) {
          target &#x3D; null;
        } else {
          // If a calculation without a form control (i.e. in .calculated-items) inside a repeat
          // has a relevant, and there 0 instances of that repeat,
          // there is nothing to remove (and target is undefined)
          // https://github.com/enketo/enketo-core/issues/761
          // TODO: It would be so much nicer if form-control-less calculations were placed inside the repeat instead.
          target &#x3D; modelClone.node(path, index).getElement();
        }

        /*
         * If performance becomes an issue, some opportunities are:
         * - check if ancestor is relevant
         * - use cache of relevant.update
         * - check for repeatClones to avoid calculating index (as in relevant.update)
         */
        if (target &amp;&amp; !that.model.evaluate(relevant, &quot;boolean&quot;, path, index)) {
          target.remove();
        }
      });

    return modelClone.getStr();
  };

  /**
   * See https://groups.google.com/forum/?fromgroups&#x3D;#!topic/opendatakit-developers/oBn7eQNQGTg
   * and http://code.google.com/p/opendatakit/issues/detail?id&#x3D;706
   *
   * This is using an aggressive name attribute selector to also find e.g. name&#x3D;&quot;/../orx:meta/orx:instanceID&quot;, with
   * *ANY* namespace prefix.
   *
   * Once the following is complete this function can and should be removed:
   *
   * 1. ODK Collect starts supporting an instanceID preload item (or automatic handling of meta-&gt;instanceID without binding)
   * 2. Pyxforms changes the instanceID binding from calculate to preload (or without binding)
   * 3. Formhub has re-generated all stored XML forms from the stored XLS forms with the updated pyxforms
   *
   */
  public grosslyViolateStandardComplianceByIgnoringCertainCalcs &#x3D; function () {
    const $culprit &#x3D; this.view.$.find(&#x27;[name$&#x3D;&quot;instanceID&quot;][data-calculate]&#x27;);
    if ($culprit.length &gt; 0) {
      $culprit.removeAttr(&quot;data-calculate&quot;);
    }
  };

  /**
   * This re-validates questions that have a dependency on a question that has just been updated.
   *
   * Note: it does not take care of re-validating a question itself after its value has changed due to a calculation update!
   *
   * @param {UpdatedDataNodes} updated - object that contains information on updated nodes
   */
  public validationUpdate &#x3D; function (updated: any &#x3D; {}) {
    if (config.validateContinuously &#x3D;&#x3D;&#x3D; true) {
      let upd &#x3D; { ...updated };
      if (updated.cloned) {
        /*
         * We don&#x27;t want requireds and constraints of questions in a newly created
         * repeat to be evaluated immediately after the repeat is created.
         * However, we do want constraints and requireds outside the repeat that
         * depend on e.g. the count() of repeats to be re-evaluated.
         * To achieve this we use a dirty trick and convert the &quot;cloned&quot; updated object
         * to a regular &quot;node&quot; updated object.
         */
        upd &#x3D; {
          nodes: updated.repeatPath.split(&quot;/&quot;).reverse().slice(0, 1),
        };
      }

      // Find all inputs that have a dependency on the changed node. Avoid duplicates with Set.
      const nodes &#x3D; new Set(this.getRelatedNodes(&quot;data-required&quot;, &quot;&quot;, upd).get());
      this.constraintAttributes.forEach((attr) &#x3D;&gt;
        this.getRelatedNodes(attr, &quot;&quot;, upd).get().forEach(nodes.add, nodes)
      );

      nodes.forEach(this.validateInput, this);
    }
  };

  /**
   * A big function that sets event handlers.
   */
  public setEventHandlers &#x3D; function () {
    const that &#x3D; this;

    // Prevent default submission, e.g. when text field is filled in and Enter key is pressed
    this.view.$.attr(&quot;onsubmit&quot;, &quot;return false;&quot;);

    /*
     * The listener below catches both change and change.file events.
     * The .file namespace is used in the filepicker to avoid an infinite loop.
     *
     * Fields with the &quot;ignore&quot; class are dynamically added to the DOM in a widget and are supposed to be handled
     * by the widget itself, e.g. the search field in a geopoint widget. They should be ignored by the main engine.
     *
     * Readonly fields are not excluded because of this scenario:
     * 1. readonly field has a calculation
     * 2. readonly field becomes non-relevant (e.g. parent group with relevant)
     * 3. this clears value in view, which should propagate to model via &#x27;change&#x27; event
     */
    this.view.$.on(
      &quot;change.file&quot;,
      &quot;input:not(.ignore), select:not(.ignore), textarea:not(.ignore)&quot;,
      function () {
        const input &#x3D; this;
        const n &#x3D; {
          path: that.input.getName(input),
          inputType: that.input.getInputType(input),
          xmlType: that.input.getXmlType(input),
          val: that.input.getVal(input),
          index: that.input.getIndex(input),
        };

        // set file input values to the uniqified actual name of file (without c://fakepath or anything like that)
        if (
          n.val.length &gt; 0 &amp;&amp;
          n.inputType &#x3D;&#x3D;&#x3D; &quot;file&quot; &amp;&amp;
          input.files[0] &amp;&amp;
          input.files[0].size &gt; 0
        ) {
          n.val &#x3D; getFilename(input.files[0], input.dataset.filenamePostfix);
        }
        if (n.val.length &gt; 0 &amp;&amp; n.inputType &#x3D;&#x3D;&#x3D; &quot;drawing&quot;) {
          n.val &#x3D; getFilename(
            {
              name: n.val,
            },
            input.dataset.filenamePostfix
          );
        }

        const updated &#x3D; that.model.node(n.path, n.index).setVal(n.val, n.xmlType);

        if (updated) {
          that.validateInput(input).then(() &#x3D;&gt; {
            // after internal processing is completed
            input.dispatchEvent(events.XFormsValueChanged({ repeatIndex: n.index }));
          });
        }
      }
    );

    // doing this on the focus event may have little effect on performance, because nothing else is happening :)
    this.view.html.addEventListener(&quot;focusin&quot;, (event) &#x3D;&gt; {
      // update the form progress status
      this.progress.update(event.target);
    });

    this.view.html.addEventListener(events.FakeFocus().type, (event) &#x3D;&gt; {
      // update the form progress status
      this.progress.update(event.target);
    });

    this.model.events.addEventListener(events.DataUpdate().type, (event) &#x3D;&gt; {
      that.evaluationCascade.forEach((fn) &#x3D;&gt; {
        fn.call(that, event.detail);
      }, true);
      // edit is fired when the model changes after the form has been initialized
      that.editStatus &#x3D; true;
    });

    this.view.html.addEventListener(events.AddRepeat().type, (event) &#x3D;&gt; {
      const $clone &#x3D; $(event.target);

      // Set template-defined static defaults of added repeats in Form, setAllVals does not trigger change event
      this.setAllVals($clone, event.detail.repeatIndex);

      // Initialize calculations, relevant, itemset, required, output inside that repeat.
      this.evaluationCascade.forEach((fn) &#x3D;&gt; {
        fn.call(that, event.detail);
      });
      this.progress.update();
    });

    this.view.html.addEventListener(events.RemoveRepeat().type, () &#x3D;&gt; {
      this.progress.update();
    });

    this.view.html.addEventListener(events.ChangeLanguage().type, () &#x3D;&gt; {
      this.output.update();
    });

    this.view.$.find(&quot;.or-group &gt; h4&quot;).on(&quot;click&quot;, function () {
      // The resize trigger is to make sure canvas widgets start working.
      $(this).closest(&quot;.or-group&quot;).toggleClass(&quot;or-appearance-compact&quot;).trigger(&quot;resize&quot;);
    });
  };

  /**
   * Removes an invalid mark on a question in the form UI.
   *
   * @param {Element} control - form control HTML element
   * @param {string} [type] - One of &quot;constraint&quot;, &quot;required&quot; and &quot;relevant&quot;.
   */
  public setValid &#x3D; function (control, type) {
    const wrap &#x3D; this.input.getWrapNode(control);

    if (!wrap) {
      // TODO: this condition occurs, at least in tests for itemsets, but we need find out how.
      return;
    }

    const classes &#x3D; type
      ? [&#x60;invalid-${type}&#x60;]
      : [...wrap.classList].filter((cl) &#x3D;&gt; cl.indexOf(&quot;invalid-&quot;) &#x3D;&#x3D;&#x3D; 0);
    wrap.classList.remove(...classes);
  };

  /**
   * Marks a question as invalid in the form UI.
   *
   * @param {Element} control - form control HTML element
   * @param {string} [type] - One of &quot;constraint&quot;, &quot;required&quot; and &quot;relevant&quot;.
   */
  public setInvalid &#x3D; function (control, type &#x3D; &quot;constraint&quot;) {
    const wrap &#x3D; this.input.getWrapNode(control);

    if (!wrap) {
      // TODO: this condition occurs, at least in tests for itemsets, but we need find out how.
      return;
    }

    if (config.validatePage &#x3D;&#x3D;&#x3D; false &amp;&amp; this.isValid(control)) {
      this.blockPageNavigation();
    }

    wrap.classList.add(&#x60;invalid-${type}&#x60;);
  };

  /**
   *
   * @param {*} control - form control HTML element
   * @param {*} result - result object obtained from Nodeset.validate
   */
  public updateValidityInUi &#x3D; function (control, result) {
    const passed &#x3D; result.requiredValid !&#x3D;&#x3D; false &amp;&amp; result.constraintValid !&#x3D;&#x3D; false;

    // Update UI
    if (result.requiredValid &#x3D;&#x3D;&#x3D; false) {
      this.setValid(control, &quot;constraint&quot;);
      this.setInvalid(control, &quot;required&quot;);
    } else if (result.constraintValid &#x3D;&#x3D;&#x3D; false) {
      this.setValid(control, &quot;required&quot;);
      this.setInvalid(control, &quot;constraint&quot;);
    } else {
      this.setValid(control, &quot;constraint&quot;);
      this.setValid(control, &quot;required&quot;);
    }

    if (!passed) {
      control.dispatchEvent(events.Invalidated());
    }
  };

  /**
   * Blocks page navigation for a short period.
   * This can be used to ensure that the user sees a new error message before moving to another page.
   */
  public blockPageNavigation &#x3D; function () {
    const that &#x3D; this;
    this.pageNavigationBlocked &#x3D; true;
    window.clearTimeout(this.blockPageNavigationTimeout);
    this.blockPageNavigationTimeout &#x3D; window.setTimeout(() &#x3D;&gt; {
      that.pageNavigationBlocked &#x3D; false;
    }, 600);
  };

  /**
   * Checks whether the question is not currently marked as invalid. If no argument is provided, it checks the whole form.
   *
   * @param {Element} node - form control HTML element
   * @return {!boolean} Whether the question/form is not marked as invalid.
   */
  public isValid &#x3D; function (node) {
    const invalidSelectors &#x3D; [&quot;.invalid-required&quot;, &quot;.invalid-relevant&quot;].concat(
      this.constraintClassesInvalid.map((cls) &#x3D;&gt; &#x60;.${cls}&#x60;)
    );
    if (node) {
      const question &#x3D; this.input.getWrapNode(node);
      const cls &#x3D; question.classList;

      return !invalidSelectors.some((selector) &#x3D;&gt; cls.contains(selector));
    }

    return !this.view.html.querySelector(invalidSelectors.join(&quot;, &quot;));
  };

  /**
   * Clears non-relevant values.
   */
  public clearNonRelevant &#x3D; function () {
    this.relevant.update(null, true);
  };

  /**
   * Clears all non-relevant question values if necessary and then
   * validates all enabled input fields after first resetting everything as valid.
   *
   * @return {Promise} wrapping {boolean} whether the form contains any errors
   */
  public validateAll &#x3D; function () {
    const that &#x3D; this;
    // to not delay validation unnecessarily we only clear non-relevants if necessary
    this.clearNonRelevant();

    return this.validateContent(this.view.$).then((valid) &#x3D;&gt; {
      that.view.html.dispatchEvent(events.ValidationComplete());

      return valid;
    });
  };

  /**
   * Alias of validateAll
   *
   * @function
   */
  public validate &#x3D; this.validateAll;

  /**
   * Validates all enabled input fields in the supplied container, after first resetting everything as valid.
   *
   * @param {jQuery} $container - HTML container element inside which to validate form controls
   * @return {Promise} wrapping {boolean} whether the container contains any errors
   */
  public validateContent &#x3D; function ($container) {
    const that &#x3D; this;
    const invalidSelector &#x3D; [&quot;.invalid-required&quot;, &quot;.invalid-relevant&quot;]
      .concat(this.constraintClassesInvalid.map((cls) &#x3D;&gt; &#x60;.${cls}&#x60;))
      .join(&quot;, &quot;);

    // can&#x27;t fire custom events on disabled elements therefore we set them all as valid
    $container
      .find(
        &quot;fieldset:disabled input, fieldset:disabled select, fieldset:disabled textarea, &quot; +
          &quot;input:disabled, select:disabled, textarea:disabled&quot;
      )
      .each(function () {
        that.setValid(this);
      });

    const validations &#x3D; $container
      .find(&quot;.question&quot;)
      .addBack(&quot;.question&quot;)
      .map(function () {
        // only trigger validate on first input and use a **pure CSS** selector (huge performance impact)
        const elem &#x3D; this.querySelector(
          &quot;input:not(.ignore):not(:disabled), select:not(.ignore):not(:disabled), textarea:not(.ignore):not(:disabled)&quot;
        );
        if (!elem) {
          return Promise.resolve();
        }

        return that.validateInput(elem);
      })
      .toArray();

    return Promise.all(validations)
      .then(() &#x3D;&gt; {
        const container &#x3D; $container[0];
        const firstError &#x3D; container.matches(invalidSelector)
          ? container
          : container.querySelector(invalidSelector);

        if (firstError) {
          that.goToTarget(firstError);
        }

        return !firstError;
      })
      .catch(
        () &#x3D;&gt;
          // fail whole-form validation if any of the question
          // validations threw.
          false
      );
  };

  /**
   * @param {string} targetPath - simple relative or absolute path
   * @param {string} contextPath - absolute context path
   * @return {string} absolute path
   */
  public pathToAbsolute &#x3D; function (targetPath, contextPath) {
    let target;

    if (targetPath.indexOf(&quot;/&quot;) &#x3D;&#x3D;&#x3D; 0) {
      return targetPath;
    }

    // index is non-relevant (no positions in returned path)
    target &#x3D; this.model.evaluate(targetPath, &quot;node&quot;, contextPath, 0, true);

    return getXPath(target, &quot;instance&quot;, false);
  };

  /**
   * @typedef ValidateInputResolution
   * @property {boolean} requiredValid
   * @property {boolean} constraintValid
   */

  /**
   * Validates question values.
   *
   * @param {Element} control - form control HTML element
   * @return {Promise&lt;undefined|ValidateInputResolution&gt;} resolves with validation result
   */
  public validateInput &#x3D; function (control) {
    if (!this.initialized) {
      return Promise.resolve();
    }
    const that &#x3D; this;
    let getValidationResult;
    // All properties, except for the **very expensive** index property
    // There is some scope for performance improvement by determining other properties when they
    // are needed, but that may not be so significant.
    const n &#x3D; {
      path: this.input.getName(control),
      inputType: this.input.getInputType(control),
      xmlType: this.input.getXmlType(control),
      enabled: this.input.isEnabled(control),
      constraint: this.input.getConstraint(control),
      calculation: this.input.getCalculation(control),
      required: this.input.getRequired(control),
      readonly: this.input.getReadonly(control),
      val: this.input.getVal(control),
    };
    // No need to validate, **nor send validation events**. Meant for simple empty &quot;notes&quot; only.
    if (n.readonly &amp;&amp; !n.val &amp;&amp; !n.required &amp;&amp; !n.constraint &amp;&amp; !n.calculation) {
      return Promise.resolve();
    }

    // The enabled check serves a purpose only when an input field itself is marked as enabled but its parent fieldset is not.
    // If an element is disabled mark it as valid (to undo a previously shown branch with fields marked as invalid).
    if (n.enabled &amp;&amp; n.inputType !&#x3D;&#x3D; &quot;hidden&quot;) {
      // Only now, will we determine the index.
      n[&quot;ind&quot;] &#x3D; this.input.getIndex(control);
      getValidationResult &#x3D; this.model
        .node(n.path, n[&quot;ind&quot;])
        .validate(n.constraint, n.required, n.xmlType);
    } else {
      getValidationResult &#x3D; Promise.resolve({
        requiredValid: true,
        constraintValid: true,
      });
    }

    return getValidationResult
      .then((result) &#x3D;&gt; {
        if (n.inputType !&#x3D;&#x3D; &quot;hidden&quot;) {
          this.updateValidityInUi(control, result);
        }

        return result;
      })
      .catch((e) &#x3D;&gt; {
        console.error(&quot;validation error&quot;, e);
        that.setInvalid(control, &quot;constraint&quot;);
        throw e;
      });
  };

  /**
   * @param {string} path - path to HTML form control
   * @return {null|Element} HTML question element
   */
  public getGoToTarget &#x3D; function (path) {
    let hits;
    let modelNode;
    let target;
    let intermediateTarget;
    let selector &#x3D; &quot;&quot;;
    const repeatRegEx &#x3D; /([^[]+)\[(\d+)\]([^[]*$)?/g;

    if (!path) {
      return;
    }

    modelNode &#x3D; this.model.node(path).getElement();

    if (!modelNode) {
      return;
    }

    // Convert to absolute path, while maintaining positions.
    path &#x3D; getXPath(modelNode, &quot;instance&quot;, true);

    // Not inside a cloned repeat.
    target &#x3D; this.view.html.querySelector(&#x60;[name&#x3D;&quot;${path}&quot;]&#x60;);

    // If inside a cloned repeat (i.e. a repeat that is not first-in-series)
    if (!target) {
      intermediateTarget &#x3D; this.view.html;
      while ((hits &#x3D; repeatRegEx.exec(path)) !&#x3D;&#x3D; null &amp;&amp; intermediateTarget) {
        selector +&#x3D; hits[1];
        intermediateTarget &#x3D; intermediateTarget.querySelectorAll(
          &#x60;[name&#x3D;&quot;${selector}&quot;], [data-name&#x3D;&quot;${selector}&quot;]&#x60;
        )[hits[2]];
        if (intermediateTarget &amp;&amp; hits[3]) {
          selector +&#x3D; hits[3];
          intermediateTarget &#x3D; intermediateTarget.querySelector(
            &#x60;[name&#x3D;&quot;${selector}&quot;],[data-name&#x3D;&quot;${selector}&quot;]&#x60;
          );
        }
        target &#x3D; intermediateTarget;
      }
    }

    return target ? this.input.getWrapNode(target) : target;
  };

  /**
   * Scrolls to an HTML question or group element, flips to the page it is on and focuses on the nearest form control.
   *
   * @param {HTMLElement} target - An HTML question or group element to scroll to
   * @return {boolean} whether target found
   */
  public goToTarget &#x3D; function (target: HTMLElement) {
    console.trace(&quot;scroll to target&quot;, target);
    if (target) {
      if (this.pages.active) {
        // Flip to page
        this.pages.flipToPageContaining($(target));
      }
      // check if the target has a form control
      if (target.closest(&quot;.calculation, .setvalue, .setgeopoint&quot;)) {
        // It is up to the apps to decide what to do with this event.
        target.dispatchEvent(events.GoToInvisible());
      }
      // check if the nearest question or group is irrelevant after page flip
      if (target.closest(&quot;.or-branch.disabled&quot;)) {
        // It is up to the apps to decide what to do with this event.
        target.dispatchEvent(events.GoToIrrelevant());
      }
      // Scroll to element
      target.scrollIntoView();
      // Focus on the first non .ignore form control
      // If the element is hidden (e.g. because it&#x27;s been replaced by a widget),
      // the focus event will not fire, so we also trigger an applyfocus event that widgets can listen for.
      const input &#x3D; target.querySelector&lt;HTMLInputElement&gt;(
        &quot;input:not(.ignore), textarea:not(.ignore), select:not(.ignore)&quot;
      );
      input.focus();
      input.dispatchEvent(events.ApplyFocus());
    }

    return !!target;
  };
}

export { Form, FormModel };
</code></pre>
    </div>
</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'class';
            var COMPODOC_CURRENT_PAGE_URL = 'Form.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
